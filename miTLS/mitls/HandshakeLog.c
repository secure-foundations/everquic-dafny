/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: D:\everest\kremlin\_build\src\Kremlin.native -minimal -add-include "kremlib.h" -fnoanonymous-unions -warn-error -9-7-6@4-14-15 -fsopts --debug,yes -verbose -library EverCrypt,EverCrypt.*,Hacl.*,Interop_assumptions,Check_sha_stdcall,Sha_update_bytes_stdcall,Check_aesni_stdcall -drop MonotoneMap -drop MonotoneMapNonDep -drop FStar.Tactics.\* -drop FStar.Tactics -drop Crypto.AEAD.\* -drop Crypto.HKDF -drop Crypto.HMAC -add-include "hacks.h" -add-include "kremlin/internal/compat.h" -bundle LowParse.\*,LowParseWrappers[rename=LowParse] -bundle Format.\* -bundle EverCrypt=EverCrypt,EverCrypt.\* -bundle FStar.\*,LowStar.\*,C,C.\*[rename=Mitls_Kremlib] -bundle Parsers.\* -bundle Spec.\* -bundle Meta.\* -bundle Lib.*[rename=Hacl_Lib] -bundle Hacl.\* -bundle KDF.\*,KDF,Idx,IV,Pkg,Pkg.\*[rename=Pkg] -bundle TLSConstants=TLSConstants,QD.TLS_protocolVersion,List.Helpers -bundle Hashing=Hashing.Spec,Hashing,Hashing.CRF,HMAC,HKDF,HMAC.UFCMA -bundle Old.Handshake=Old.HMAC.UFCMA,Old.Epochs,Old.KeySchedule,Old.Handshake -bundle StatefulLHAE=AEAD_GCM,LHAEPlain,StatefulPlain,StatefulLHAE -bundle StreamAE=StreamPlain,StreamAE -bundle CommonDH=TLS.Curve25519,DHGroup,ECGroup,CommonDH -bundle Content=Content,DataStream -bundle Record=Record,StAE,Transport,StreamDeltas -bundle PMS=PMS,RSAKey,TLSPRF -bundle Crypto.Plain=Buffer.Utils,Crypto.Indexing,Crypto.Plain,Crypto.Symmetric.Bytes -bundle Flags=DebugFlags,Flags,Flag,TLSInfoFlags -bundle Vale.Stdcalls.*,Vale.Interop,Vale.Interop.*,Vale.Wrapper.X64.*[rename=Vale] -bundle Vale.Inline.X64.*[rename=Vale_Inline] -bundle Vale.*[rename=Unused2] -ldopts -L,D:/everest/MLCrypto/openssl,-lcrypto,-lssl extract/Kremlin/FStar_Pervasives_Native.krml extract/Kremlin/FStar_Pervasives.krml extract/Kremlin/FStar_Squash.krml extract/Kremlin/FStar_Classical.krml extract/Kremlin/FStar_Preorder.krml extract/Kremlin/FStar_Calc.krml extract/Kremlin/FStar_Mul.krml extract/Kremlin/FStar_Math_Lib.krml extract/Kremlin/FStar_Math_Lemmas.krml extract/Kremlin/FStar_StrongExcludedMiddle.krml extract/Kremlin/FStar_FunctionalExtensionality.krml extract/Kremlin/FStar_List_Tot_Base.krml extract/Kremlin/FStar_List_Tot_Properties.krml extract/Kremlin/FStar_List_Tot.krml extract/Kremlin/FStar_Seq_Base.krml extract/Kremlin/FStar_Seq_Properties.krml extract/Kremlin/FStar_Seq.krml extract/Kremlin/FStar_BitVector.krml extract/Kremlin/FStar_UInt.krml extract/Kremlin/FStar_UInt32.krml extract/Kremlin/FStar_UInt8.krml extract/Kremlin/FStar_Exn.krml extract/Kremlin/FStar_Set.krml extract/Kremlin/FStar_Monotonic_Witnessed.krml extract/Kremlin/FStar_Ghost.krml extract/Kremlin/FStar_ErasedLogic.krml extract/Kremlin/FStar_PropositionalExtensionality.krml extract/Kremlin/FStar_PredicateExtensionality.krml extract/Kremlin/FStar_TSet.krml extract/Kremlin/FStar_Monotonic_Heap.krml extract/Kremlin/FStar_Heap.krml extract/Kremlin/FStar_ST.krml extract/Kremlin/FStar_All.krml extract/Kremlin/Lib_LoopCombinators.krml extract/Kremlin/FStar_Int.krml extract/Kremlin/FStar_Int64.krml extract/Kremlin/FStar_Int63.krml extract/Kremlin/FStar_Int32.krml extract/Kremlin/FStar_Int16.krml extract/Kremlin/FStar_Int8.krml extract/Kremlin/FStar_UInt64.krml extract/Kremlin/FStar_UInt63.krml extract/Kremlin/FStar_UInt16.krml extract/Kremlin/FStar_Int_Cast.krml extract/Kremlin/FStar_UInt128.krml extract/Kremlin/FStar_Int_Cast_Full.krml extract/Kremlin/FStar_Int128.krml extract/Kremlin/Lib_IntTypes.krml extract/Kremlin/Lib_RawIntTypes.krml extract/Kremlin/Lib_Sequence.krml extract/Kremlin/Lib_ByteSequence.krml extract/Kremlin/Spec_Chacha20.krml extract/Kremlin/Meta_Attribute.krml extract/Kremlin/FStar_Map.krml extract/Kremlin/FStar_Monotonic_HyperHeap.krml extract/Kremlin/FStar_Monotonic_HyperStack.krml extract/Kremlin/FStar_HyperStack.krml extract/Kremlin/FStar_HyperStack_ST.krml extract/Kremlin/FStar_Universe.krml extract/Kremlin/FStar_GSet.krml extract/Kremlin/FStar_ModifiesGen.krml extract/Kremlin/FStar_Range.krml extract/Kremlin/FStar_Reflection_Types.krml extract/Kremlin/FStar_Tactics_Types.krml extract/Kremlin/FStar_Tactics_Result.krml extract/Kremlin/FStar_Tactics_Effect.krml extract/Kremlin/FStar_Reflection_Data.krml extract/Kremlin/FStar_Tactics_Builtins.krml extract/Kremlin/FStar_Reflection_Const.krml extract/Kremlin/FStar_Char.krml extract/Kremlin/FStar_List.krml extract/Kremlin/FStar_String.krml extract/Kremlin/FStar_Order.krml extract/Kremlin/FStar_Reflection_Basic.krml extract/Kremlin/FStar_Reflection_Derived.krml extract/Kremlin/FStar_Reflection_Derived_Lemmas.krml extract/Kremlin/FStar_Reflection.krml extract/Kremlin/FStar_Tactics_SyntaxHelpers.krml extract/Kremlin/FStar_Tactics_Util.krml extract/Kremlin/FStar_Reflection_Formula.krml extract/Kremlin/FStar_Tactics_Derived.krml extract/Kremlin/FStar_Tactics_Logic.krml extract/Kremlin/FStar_Tactics.krml extract/Kremlin/FStar_BigOps.krml extract/Kremlin/LowStar_Monotonic_Buffer.krml extract/Kremlin/LowStar_Buffer.krml extract/Kremlin/LowStar_BufferOps.krml extract/Kremlin/Spec_Loops.krml extract/Kremlin/C_Loops.krml extract/Kremlin/Lib_Loops.krml extract/Kremlin/FStar_Endianness.krml extract/Kremlin/LowStar_Endianness.krml extract/Kremlin/LowStar_ImmutableBuffer.krml extract/Kremlin/Lib_Buffer.krml extract/Kremlin/Lib_ByteBuffer.krml extract/Kremlin/FStar_HyperStack_All.krml extract/Kremlin/Lib_IntVector_Intrinsics.krml extract/Kremlin/Spec_GaloisField.krml extract/Kremlin/Spec_AES.krml extract/Kremlin/Lib_IntVector.krml extract/Kremlin/Hacl_Spec_Chacha20_Vec.krml extract/Kremlin/Hacl_Spec_Chacha20_Lemmas.krml extract/Kremlin/Lib_Sequence_Lemmas.krml extract/Kremlin/Hacl_Spec_Chacha20_Equiv.krml extract/Kremlin/Hacl_Impl_Chacha20_Core32xN.krml extract/Kremlin/Hacl_Impl_Chacha20_Vec.krml extract/Kremlin/Vale_Lib_Seqs_s.krml extract/Kremlin/Vale_Def_Words_s.krml extract/Kremlin/Vale_Def_Words_Four_s.krml extract/Kremlin/Vale_Def_Words_Two_s.krml extract/Kremlin/Vale_Def_Words_Seq_s.krml extract/Kremlin/Vale_Def_Opaque_s.krml extract/Kremlin/Vale_Def_Types_s.krml extract/Kremlin/Vale_X64_Machine_s.krml extract/Kremlin/Vale_Lib_Map16.krml extract/Kremlin/Vale_Def_Prop_s.krml extract/Kremlin/Vale_X64_Flags.krml extract/Kremlin/Vale_X64_CPU_Features_s.krml extract/Kremlin/Vale_Curve25519_Fast_lemmas_internal.krml extract/Kremlin/Vale_Lib_Meta.krml extract/Kremlin/Vale_Def_Words_Two.krml extract/Kremlin/Vale_Lib_Seqs.krml extract/Kremlin/Vale_Def_TypesNative_s.krml extract/Kremlin/Vale_Arch_TypesNative.krml extract/Kremlin/Vale_Def_Words_Seq.krml extract/Kremlin/Vale_Arch_Types.krml extract/Kremlin/Vale_Curve25519_Fast_defs.krml extract/Kremlin/FStar_Algebra_CommMonoid.krml extract/Kremlin/FStar_Tactics_CanonCommSemiring.krml extract/Kremlin/Vale_Curve25519_FastUtil_helpers.krml extract/Kremlin/Vale_Curve25519_FastHybrid_helpers.krml extract/Kremlin/Vale_Curve25519_Fast_lemmas_external.krml extract/Kremlin/Vale_X64_Regs.krml extract/Kremlin/FStar_Float.krml extract/Kremlin/FStar_IO.krml extract/Kremlin/Vale_Def_PossiblyMonad.krml extract/Kremlin/LowStar_BufferView_Down.krml extract/Kremlin/LowStar_BufferView_Up.krml extract/Kremlin/Vale_Interop_Views.krml extract/Kremlin/FStar_Option.krml extract/Kremlin/Vale_Lib_Set.krml extract/Kremlin/Vale_X64_Instruction_s.krml extract/Kremlin/Vale_X64_Bytes_Code_s.krml extract/Kremlin/Vale_AES_AES_s.krml extract/Kremlin/Vale_Math_Poly2_Defs_s.krml extract/Kremlin/Vale_Math_Poly2_s.krml extract/Kremlin/Vale_Math_Poly2_Bits_s.krml extract/Kremlin/Spec_Hash_Definitions.krml extract/Kremlin/Spec_Hash_Lemmas0.krml extract/Kremlin/Spec_Hash_PadFinish.krml extract/Kremlin/Spec_SHA2_Constants.krml extract/Kremlin/Spec_SHA2.krml extract/Kremlin/Vale_X64_CryptoInstructions_s.krml extract/Kremlin/Vale_X64_Instructions_s.krml extract/Kremlin/Vale_Arch_HeapTypes_s.krml extract/Kremlin/Vale_Interop_Types.krml extract/Kremlin/Vale_Arch_MachineHeap_s.krml extract/Kremlin/Vale_Interop_Heap_s.krml extract/Kremlin/LowStar_Modifies.krml extract/Kremlin/LowStar_ModifiesPat.krml extract/Kremlin/LowStar_BufferView.krml extract/Kremlin/Vale_Lib_BufferViewHelpers.krml extract/Kremlin/Vale_Interop.krml extract/Kremlin/Vale_Arch_HeapImpl.krml extract/Kremlin/Vale_Arch_Heap.krml extract/Kremlin/Vale_X64_Machine_Semantics_s.krml extract/Kremlin/Vale_Interop_Base.krml extract/Kremlin/Vale_X64_Memory.krml extract/Kremlin/Vale_Arch_MachineHeap.krml extract/Kremlin/Vale_X64_Stack_i.krml extract/Kremlin/Vale_X64_Stack_Sems.krml extract/Kremlin/Vale_X64_BufferViewStore.krml extract/Kremlin/Vale_X64_Memory_Sems.krml extract/Kremlin/Vale_X64_State.krml extract/Kremlin/Vale_X64_StateLemmas.krml extract/Kremlin/Vale_X64_Lemmas.krml extract/Kremlin/Vale_X64_Print_s.krml extract/Kremlin/Vale_X64_Decls.krml extract/Kremlin/Vale_X64_QuickCode.krml extract/Kremlin/Vale_X64_QuickCodes.krml extract/Kremlin/Vale_X64_Taint_Semantics.krml extract/Kremlin/Vale_X64_InsLemmas.krml extract/Kremlin/Vale_X64_InsBasic.krml extract/Kremlin/Vale_X64_InsMem.krml extract/Kremlin/Vale_X64_InsVector.krml extract/Kremlin/Vale_X64_InsStack.krml extract/Kremlin/Vale_Curve25519_X64_FastHybrid.krml extract/Kremlin/Vale_Bignum_Defs.krml extract/Kremlin/Vale_Bignum_X64.krml extract/Kremlin/Vale_Curve25519_FastSqr_helpers.krml extract/Kremlin/Vale_Curve25519_X64_FastSqr.krml extract/Kremlin/Vale_Curve25519_FastMul_helpers.krml extract/Kremlin/Vale_Curve25519_X64_FastMul.krml extract/Kremlin/Vale_Curve25519_X64_FastWide.krml extract/Kremlin/Vale_Curve25519_X64_FastUtil.krml extract/Kremlin/Vale_X64_MemoryAdapters.krml extract/Kremlin/Vale_Interop_Assumptions.krml extract/Kremlin/Vale_Interop_X64.krml extract/Kremlin/Vale_AsLowStar_ValeSig.krml extract/Kremlin/Vale_AsLowStar_LowStarSig.krml extract/Kremlin/Vale_AsLowStar_MemoryHelpers.krml extract/Kremlin/Vale_AsLowStar_Wrapper.krml extract/Kremlin/Vale_Stdcalls_X64_Fadd.krml extract/Kremlin/Vale_Wrapper_X64_Fadd.krml extract/Kremlin/Spec_SHA1.krml extract/Kremlin/Spec_MD5.krml extract/Kremlin/Spec_Agile_Hash.krml extract/Kremlin/Spec_Hash_Incremental.krml extract/Kremlin/Spec_Hash_Lemmas.krml extract/Kremlin/FStar_Kremlin_Endianness.krml extract/Kremlin/Hacl_Hash_Lemmas.krml extract/Kremlin/Hacl_Hash_Definitions.krml extract/Kremlin/Hacl_Hash_PadFinish.krml extract/Kremlin/Hacl_Hash_MD.krml extract/Kremlin/Spec_SHA2_Lemmas.krml extract/Kremlin/Vale_X64_Stack.krml extract/Kremlin/Vale_SHA_SHA_helpers.krml extract/Kremlin/Vale_X64_InsSha.krml extract/Kremlin/Vale_SHA_X64.krml extract/Kremlin/Vale_Stdcalls_X64_Sha.krml extract/Kremlin/FStar_BV.krml extract/Kremlin/FStar_Reflection_Arith.krml extract/Kremlin/FStar_Tactics_BV.krml extract/Kremlin/Vale_Lib_Bv_s.krml extract/Kremlin/Vale_Math_Bits.krml extract/Kremlin/Vale_Lib_Tactics.krml extract/Kremlin/Vale_Poly1305_Bitvectors.krml extract/Kremlin/Vale_Math_Lemmas_Int.krml extract/Kremlin/FStar_Tactics_Canon.krml extract/Kremlin/Vale_Poly1305_Spec_s.krml extract/Kremlin/Vale_Poly1305_Math.krml extract/Kremlin/Vale_Poly1305_Util.krml extract/Kremlin/Vale_Poly1305_X64.krml extract/Kremlin/Vale_Stdcalls_X64_Poly.krml extract/Kremlin/Vale_Wrapper_X64_Poly.krml extract/Kremlin/Vale_Arch_BufferFriend.krml extract/Kremlin/Vale_SHA_Simplify_Sha.krml extract/Kremlin/Vale_Wrapper_X64_Sha.krml extract/Kremlin/Hacl_Hash_Core_SHA2_Constants.krml extract/Kremlin/Hacl_Hash_Core_SHA2.krml extract/Kremlin/Hacl_Hash_SHA2.krml extract/Kremlin/Hacl_Hash_Core_SHA1.krml extract/Kremlin/Hacl_Hash_SHA1.krml extract/Kremlin/Hacl_Hash_Core_MD5.krml extract/Kremlin/Hacl_Hash_MD5.krml extract/Kremlin/C.krml extract/Kremlin/C_String.krml extract/Kremlin/C_Failure.krml extract/Kremlin/FStar_Int31.krml extract/Kremlin/FStar_UInt31.krml extract/Kremlin/FStar_Integers.krml extract/Kremlin/EverCrypt_StaticConfig.krml extract/Kremlin/EverCrypt_TargetConfig.krml extract/Kremlin/Vale_Lib_Basic.krml extract/Kremlin/Vale_Lib_X64_Cpuid.krml extract/Kremlin/Vale_Lib_X64_Cpuidstdcall.krml extract/Kremlin/Vale_Stdcalls_X64_Cpuid.krml extract/Kremlin/Vale_Wrapper_X64_Cpuid.krml extract/Kremlin/EverCrypt_AutoConfig2.krml extract/Kremlin/EverCrypt_Helpers.krml extract/Kremlin/EverCrypt_Hash.krml extract/Kremlin/Spec_Agile_HMAC.krml extract/Kremlin/Hacl_HMAC.krml extract/Kremlin/EverCrypt_HMAC.krml extract/Kremlin/Declassify.krml extract/Kremlin/FStar_Bytes.krml extract/Kremlin/Hashing_Spec.krml extract/Kremlin/LowParse_Bytes32.krml extract/Kremlin/LowParse_Bytes.krml extract/Kremlin/LowParse_Spec_Base.krml extract/Kremlin/LowParse_SLow_Base.krml extract/Kremlin/LowParse_Spec_Option.krml extract/Kremlin/LowParse_SLow_Option.krml extract/Kremlin/LowParse_Spec_Combinators.krml extract/Kremlin/LowParse_Spec_IfThenElse.krml extract/Kremlin/LowParse_SLow_Combinators.krml extract/Kremlin/LowParse_Spec_List.krml extract/Kremlin/LowParse_SLow_List.krml extract/Kremlin/Spec_Curve25519_Lemmas.krml extract/Kremlin/Spec_Curve25519.krml extract/Kremlin/Hacl_Spec_Curve25519_AddAndDouble.krml extract/Kremlin/Hacl_Impl_Curve25519_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Definition.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Core.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51_Definition.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51.krml extract/Kremlin/Hacl_Impl_Curve25519_Fields_Core.krml extract/Kremlin/Hacl_Impl_Curve25519_Field64.krml extract/Kremlin/Hacl_Impl_Curve25519_Field51.krml extract/Kremlin/Hacl_Impl_Curve25519_Fields.krml extract/Kremlin/Hacl_Impl_Curve25519_AddAndDouble.krml extract/Kremlin/Spec_Poly1305.krml extract/Kremlin/Hacl_Spec_Poly1305_Vec.krml extract/Kremlin/Hacl_Spec_Poly1305_Field32xN.krml extract/Kremlin/Hacl_Poly1305_Field32xN_Lemmas.krml extract/Kremlin/Hacl_Impl_Poly1305_Lemmas.krml extract/Kremlin/Hacl_Spec_Poly1305_Field32xN_Lemmas.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN.krml extract/Kremlin/Hacl_Spec_Poly1305_Lemmas.krml extract/Kremlin/Hacl_Spec_Poly1305_Equiv.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_256.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_128.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_32.krml extract/Kremlin/Hacl_Impl_Poly1305_Fields.krml extract/Kremlin/Hacl_Impl_Poly1305.krml extract/Kremlin/Spec_Chacha20Poly1305.krml extract/Kremlin/Hacl_Impl_Chacha20Poly1305_PolyCore.krml extract/Kremlin/Hacl_Impl_Chacha20Poly1305.krml extract/Kremlin/FStar_List_Pure_Base.krml extract/Kremlin/FStar_List_Pure_Properties.krml extract/Kremlin/FStar_List_Pure.krml extract/Kremlin/Meta_Interface.krml extract/Kremlin/Hacl_Meta_Chacha20Poly1305.krml extract/Kremlin/Hacl_Impl_Chacha20_Core32.krml extract/Kremlin/Hacl_Impl_Chacha20.krml extract/Kremlin/Hacl_Chacha20.krml extract/Kremlin/Hacl_Meta_Poly1305.krml extract/Kremlin/Hacl_Poly1305_32.krml extract/Kremlin/Hacl_Chacha20Poly1305_32.krml extract/Kremlin/FStar_Dyn.krml extract/Kremlin/LowStar_Failure.krml extract/Kremlin/EverCrypt_Vale.krml extract/Kremlin/EverCrypt_Specs.krml extract/Kremlin/EverCrypt_OpenSSL.krml extract/Kremlin/EverCrypt_Hacl.krml extract/Kremlin/EverCrypt_BCrypt.krml extract/Kremlin/EverCrypt_Cipher.krml extract/Kremlin/Hacl_Spec_Curve25519_Finv.krml extract/Kremlin/Hacl_Impl_Curve25519_Finv.krml extract/Kremlin/Hacl_Impl_Curve25519_Generic.krml extract/Kremlin/Hacl_Meta_Curve25519.krml extract/Kremlin/Hacl_Curve25519_51.krml extract/Kremlin/Vale_Stdcalls_X64_Fswap.krml extract/Kremlin/Vale_Wrapper_X64_Fswap.krml extract/Kremlin/Vale_X64_Print_Inline_s.krml extract/Kremlin/Vale_Inline_X64_Fswap_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fsqr.krml extract/Kremlin/Vale_Wrapper_X64_Fsqr.krml extract/Kremlin/Vale_Inline_X64_Fsqr_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fmul.krml extract/Kremlin/Vale_Wrapper_X64_Fmul.krml extract/Kremlin/Vale_Inline_X64_Fmul_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fsub.krml extract/Kremlin/Vale_Wrapper_X64_Fsub.krml extract/Kremlin/Vale_Inline_X64_Fadd_inline.krml extract/Kremlin/Hacl_Impl_Curve25519_Field64_Vale.krml extract/Kremlin/Hacl_Curve25519_64.krml extract/Kremlin/EverCrypt_Curve25519.krml extract/Kremlin/Hacl_Poly1305_128.krml extract/Kremlin/Hacl_Poly1305_256.krml extract/Kremlin/Vale_Poly1305_Equiv.krml extract/Kremlin/Vale_Poly1305_CallingFromLowStar.krml extract/Kremlin/EverCrypt_Poly1305.krml extract/Kremlin/Lib_Memzero.krml extract/Kremlin/Spec_HMAC_DRBG.krml extract/Kremlin/Hacl_HMAC_DRBG.krml extract/Kremlin/Lib_RandomBuffer_System.krml extract/Kremlin/EverCrypt_DRBG.krml extract/Kremlin/Spec_Agile_HKDF.krml extract/Kremlin/Hacl_HKDF.krml extract/Kremlin/EverCrypt_HKDF.krml extract/Kremlin/EverCrypt.krml extract/Kremlin/FStar_Printf.krml extract/Kremlin/FStar_Error.krml extract/Kremlin/FStar_Tcp.krml extract/Kremlin/LowParse_Spec_FLData.krml extract/Kremlin/LowParse_Math.krml extract/Kremlin/LowParse_Slice.krml extract/Kremlin/LowParse_Low_Base.krml extract/Kremlin/LowParse_Low_Combinators.krml extract/Kremlin/LowParse_Low_FLData.krml extract/Kremlin/LowParse_Spec_Seq.krml extract/Kremlin/LowParse_Spec_Int.krml extract/Kremlin/LowParse_Spec_BoundedInt.krml extract/Kremlin/LowParse_Low_Endianness.krml extract/Kremlin/LowParse_BitFields.krml extract/Kremlin/LowParse_Endianness.krml extract/Kremlin/LowParse_Endianness_BitFields.krml extract/Kremlin/LowParse_Low_BoundedInt.krml extract/Kremlin/LowParse_Spec_SeqBytes_Base.krml extract/Kremlin/LowParse_Spec_DER.krml extract/Kremlin/LowParse_Spec_BCVLI.krml extract/Kremlin/LowParse_Spec_AllIntegers.krml extract/Kremlin/LowParse_Spec_VLData.krml extract/Kremlin/LowParse_Low_VLData.krml extract/Kremlin/LowParse_Spec_VLGen.krml extract/Kremlin/LowParse_Low_VLGen.krml extract/Kremlin/LowParse_Low_Int.krml extract/Kremlin/LowParse_Low_DER.krml extract/Kremlin/LowParse_Low_BCVLI.krml extract/Kremlin/LowParse_Low_List.krml extract/Kremlin/LowParse_Spec_Array.krml extract/Kremlin/LowParse_Spec_VCList.krml extract/Kremlin/LowParse_Low_VCList.krml extract/Kremlin/LowParse_Low_IfThenElse.krml extract/Kremlin/LowParse_TacLib.krml extract/Kremlin/LowParse_Spec_Enum.krml extract/Kremlin/LowParse_Spec_Sum.krml extract/Kremlin/LowParse_Low_Enum.krml extract/Kremlin/LowParse_Low_Sum.krml extract/Kremlin/LowParse_Low_Tac_Sum.krml extract/Kremlin/LowParse_Low_Option.krml extract/Kremlin/LowParse_Spec_Bytes.krml extract/Kremlin/LowParse_Low_Bytes.krml extract/Kremlin/LowParse_Low_Array.krml extract/Kremlin/LowParse_Low.krml extract/Kremlin/LowParse_SLow_FLData.krml extract/Kremlin/LowParse_SLow_VLGen.krml extract/Kremlin/LowParse_Spec_Endianness.krml extract/Kremlin/LowParse_Spec_Endianness_Instances.krml extract/Kremlin/LowParse_SLow_Endianness.krml extract/Kremlin/LowParse_SLow_BoundedInt.krml extract/Kremlin/LowParse_SLow_Int.krml extract/Kremlin/LowParse_SLow_DER.krml extract/Kremlin/LowParse_SLow_BCVLI.krml extract/Kremlin/LowParse_SLow_VCList.krml extract/Kremlin/LowParse_SLow_IfThenElse.krml extract/Kremlin/LowParse_SLow_Enum.krml extract/Kremlin/LowParse_SLow_Sum.krml extract/Kremlin/LowParse_SLow_Tac_Enum.krml extract/Kremlin/LowParse_SLow_Tac_Sum.krml extract/Kremlin/LowParse_SLow_VLData.krml extract/Kremlin/LowParse_SLow_Bytes.krml extract/Kremlin/LowParse_SLow_Array.krml extract/Kremlin/LowParse_Spec_Tac_Combinators.krml extract/Kremlin/LowParse_SLow.krml extract/Kremlin/Parsers_AlertDescription.krml extract/Kremlin/Parsers_AlertLevel.krml extract/Kremlin/Parsers_Alert.krml extract/Kremlin/TLSError.krml extract/Kremlin/Parsers_NamedGroup.krml extract/Kremlin/Format_Constants.krml extract/Kremlin/Format_UncompressedPointRepresentation.krml extract/Kremlin/Format_KeyShareEntry.krml extract/Kremlin/Flags.krml extract/Kremlin/Parsers_ECCurveType.krml extract/Kremlin/DebugFlags.krml extract/Kremlin/FStar_DependentMap.krml extract/Kremlin/FStar_Monotonic_DependentMap.krml extract/Kremlin/Mem.krml extract/Kremlin/Random.krml extract/Kremlin/TLS_Curve25519.krml extract/Kremlin/Parse.krml extract/Kremlin/ECGroup.krml extract/Kremlin/DHGroup.krml extract/Kremlin/Parsers_NamedGroupList.krml extract/Kremlin/CommonDH.krml extract/Kremlin/FFICallbacks.krml extract/Kremlin/Parsers_CompressionMethod.krml extract/Kremlin/Parsers_SignatureScheme.krml extract/Kremlin/Parsers_SignatureSchemeList.krml extract/Kremlin/LowParseWrappers.krml extract/Kremlin/Parsers_CipherSuite.krml extract/Kremlin/CipherSuite.krml extract/Kremlin/Parsers_ProtocolVersion.krml extract/Kremlin/TLSConstants.krml extract/Kremlin/HMAC.krml extract/Kremlin/RSAKey.krml extract/Kremlin/PMS.krml extract/Kremlin/List_Helpers.krml extract/Kremlin/PSK.krml extract/Kremlin/Extensions.krml extract/Kremlin/Cert.krml extract/Kremlin/TLSInfoFlags.krml extract/Kremlin/FStar_Date.krml extract/Kremlin/Nonce.krml extract/Kremlin/TLSInfo.krml extract/Kremlin/Crypto_Indexing.krml extract/Kremlin/Flag.krml extract/Kremlin/FStar_Old_Endianness.krml extract/Kremlin/FStar_Buffer.krml extract/Kremlin/C_Compat_Loops.krml extract/Kremlin/Buffer_Utils.krml extract/Kremlin/Crypto_Symmetric_Bytes.krml extract/Kremlin/Crypto_Plain.krml extract/Kremlin/AEADProvider.krml extract/Kremlin/Range.krml extract/Kremlin/DataStream.krml extract/Kremlin/Alert.krml extract/Kremlin/Content.krml extract/Kremlin/StreamPlain.krml extract/Kremlin/Hashing.krml extract/Kremlin/TLSPRF.krml extract/Kremlin/Hashing_CRF.krml extract/Kremlin/HandshakeMessages.krml extract/Kremlin/HandshakeLog.krml extract/Kremlin/Parsers_Boolean.krml extract/Kremlin/Parsers_TicketContents13_custom_data.krml extract/Kremlin/Parsers_TicketContents13_nonce.krml extract/Kremlin/Parsers_TicketContents13_rms.krml extract/Kremlin/Parsers_TicketContents13.krml extract/Kremlin/Parsers_TicketContents12_master_secret.krml extract/Kremlin/Parsers_TicketContents12.krml extract/Kremlin/Parsers_TicketVersion.krml extract/Kremlin/Parsers_TicketContents.krml extract/Kremlin/Parsers_TicketContents12_master_secret_Low.krml extract/Kremlin/Parsers_Ticket_Low.krml extract/Kremlin/Ticket.krml extract/Kremlin/Negotiation.krml extract/Kremlin/FStar_Monotonic_Seq.krml extract/Kremlin/StreamAE.krml extract/Kremlin/StatefulPlain.krml extract/Kremlin/LHAEPlain.krml extract/Kremlin/AEAD_GCM.krml extract/Kremlin/StatefulLHAE.krml extract/Kremlin/StAE.krml extract/Kremlin/Old_HMAC_UFCMA.krml extract/Kremlin/Parsers_HKDF_HkdfLabel_context.krml extract/Kremlin/Parsers_HKDF_HkdfLabel_label.krml extract/Kremlin/Parsers_HKDF_HkdfLabel.krml extract/Kremlin/HKDF.krml extract/Kremlin/Old_KeySchedule.krml extract/Kremlin/Old_Epochs.krml extract/Kremlin/FStar_HyperStack_IO.krml extract/Kremlin/StreamDeltas.krml extract/Kremlin/Old_Handshake.krml extract/Kremlin/Transport.krml extract/Kremlin/BufferBytes.krml extract/Kremlin/Record.krml extract/Kremlin/Connection.krml extract/Kremlin/TLS.krml extract/Kremlin/FFI.krml extract/Kremlin/Pkg.krml extract/Kremlin/Idx.krml extract/Kremlin/Model.krml extract/Kremlin/FStar_Test.krml extract/Kremlin/Pkg_Tree.krml extract/Kremlin/KDF.krml extract/Kremlin/QUIC.krml extract/Kremlin/IV.krml extract/Kremlin/KDF_Rekey.krml -tmpdir extract/Kremlin-Library -skip-compilation
  F* version: 1f9505d5
  KreMLin version: 44acff92
 */

#include "HandshakeLog.h"

bool HandshakeLog_eoflight(HandshakeMessages_hs_msg uu___0_33)
{
  if (uu___0_33.tag == HandshakeMessages_ClientHello)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_HelloRetryRequest)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_EndOfEarlyData)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_ServerHello)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_ServerHelloDone)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_NewSessionTicket13)
    return true;
  else if (uu___0_33.tag == HandshakeMessages_Finished)
    return true;
  else
    return false;
}

bool HandshakeLog_tagged(HandshakeMessages_hs_msg m)
{
  if (m.tag == HandshakeMessages_ClientHello)
    return true;
  else if (m.tag == HandshakeMessages_ServerHello)
    return true;
  else if (m.tag == HandshakeMessages_EndOfEarlyData)
    return true;
  else if (m.tag == HandshakeMessages_Certificate13)
    return true;
  else if (m.tag == HandshakeMessages_EncryptedExtensions)
    return true;
  else if (m.tag == HandshakeMessages_CertificateVerify)
    return true;
  else if (m.tag == HandshakeMessages_ClientKeyExchange)
    return true;
  else if (m.tag == HandshakeMessages_NewSessionTicket)
    return true;
  else if (m.tag == HandshakeMessages_Finished)
    return true;
  else
    return false;
}

bool HandshakeLog_weak_valid_transcript(Prims_list__HandshakeMessages_hs_msg *hsl)
{
  if (hsl->tag == Prims_Nil)
    return true;
  else if
  (
    hsl->tag
    == Prims_Cons
    && hsl->hd.tag == HandshakeMessages_ClientHello && hsl->tl->tag == Prims_Nil
  )
    return true;
  else if
  (
    hsl->tag
    == Prims_Cons
    &&
      hsl->hd.tag
      == HandshakeMessages_ClientHello
      && hsl->tl->tag == Prims_Cons && hsl->tl->hd.tag == HandshakeMessages_ServerHello
  )
    return true;
  else
    return false;
}

FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion
HandshakeLog_transcript_version(Prims_list__HandshakeMessages_hs_msg *x)
{
  if
  (
    x->tag
    == Prims_Cons
    &&
      x->hd.tag
      == HandshakeMessages_ClientHello
      && x->tl->tag == Prims_Cons && x->tl->hd.tag == HandshakeMessages_ServerHello
  )
  {
    HandshakeMessages_sh sh = x->tl->hd.val.case_ServerHello;
    return
      (
        (FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion){
          .tag = FStar_Pervasives_Native_Some,
          .v = sh.sh_protocol_version
        }
      );
  }
  else
    return
      (
        (FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion){
          .tag = FStar_Pervasives_Native_None
        }
      );
}

static Prims_list__HandshakeMessages_hs_msg
*FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(
  Prims_list__HandshakeMessages_hs_msg *x,
  Prims_list__HandshakeMessages_hs_msg *y
)
{
  if (x->tag == Prims_Nil)
    return y;
  else if (x->tag == Prims_Cons)
  {
    Prims_list__HandshakeMessages_hs_msg *tl1 = x->tl;
    HandshakeMessages_hs_msg a = x->hd;
    KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
    Prims_list__HandshakeMessages_hs_msg
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
    buf[0U]
    =
      (
        (Prims_list__HandshakeMessages_hs_msg){
          .tag = Prims_Cons,
          .hd = a,
          .tl = FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(tl1, y)
        }
      );
    return buf;
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Prims_list__HandshakeMessages_hs_msg
*HandshakeLog_append_transcript(
  Prims_list__HandshakeMessages_hs_msg *l,
  Prims_list__HandshakeMessages_hs_msg *m
)
{
  return FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(l, m);
}

static void HandshakeLog_discard(bool uu____183)
{
  
}

static void HandshakeLog_print(Prims_string s)
{
  HandshakeLog_discard(FStar_IO_debug_print_string(Prims_strcat("HSL| ", Prims_strcat(s, "\n"))));
}

FStar_Bytes_bytes HandshakeLog_narrowTag(Spec_Hash_Definitions_hash_alg a, FStar_Bytes_bytes b)
{
  return b;
}

uint32_t HandshakeLog_hash_length(FStar_Bytes_bytes b)
{
  return FStar_Bytes_len(b);
}

bool
HandshakeLog_uu___is_OpenHash(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_OpenHash)
    return true;
  else
    return false;
}

FStar_Bytes_bytes
HandshakeLog___proj__OpenHash__item__b(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_OpenHash)
    return projectee.val.case_OpenHash;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool
HandshakeLog_uu___is_FixedHash(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_FixedHash)
    return true;
  else
    return false;
}

Spec_Hash_Definitions_hash_alg
HandshakeLog___proj__FixedHash__item__a(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_FixedHash)
    return projectee.val.case_FixedHash.a;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Bytes_bytes
HandshakeLog___proj__FixedHash__item__state(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_FixedHash)
    return projectee.val.case_FixedHash.state;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Prims_list__FStar_Bytes_bytes
*HandshakeLog___proj__FixedHash__item__hashes(
  Prims_list__HandshakeMessages_hs_msg *parsed1,
  HandshakeLog_hashState projectee
)
{
  if (projectee.tag == HandshakeLog_FixedHash)
    return projectee.val.case_FixedHash.hashes;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool HandshakeLog_uu___is_State(HandshakeLog_state projectee)
{
  return true;
}

FStar_Bytes_bytes HandshakeLog___proj__State__item__outgoing(HandshakeLog_state projectee)
{
  return projectee.outgoing;
}

FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
HandshakeLog___proj__State__item__outgoing_next_keys(HandshakeLog_state projectee)
{
  return projectee.outgoing_next_keys;
}

bool HandshakeLog___proj__State__item__outgoing_complete(HandshakeLog_state projectee)
{
  return projectee.outgoing_complete;
}

FStar_Bytes_bytes HandshakeLog___proj__State__item__incoming(HandshakeLog_state projectee)
{
  return projectee.incoming;
}

Prims_list__HandshakeMessages_hs_msg
*HandshakeLog___proj__State__item__parsed(HandshakeLog_state projectee)
{
  return projectee.parsed;
}

HandshakeLog_hashState HandshakeLog___proj__State__item__hashes(HandshakeLog_state projectee)
{
  return projectee.hashes;
}

FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion
HandshakeLog___proj__State__item__pv(HandshakeLog_state projectee)
{
  return projectee.pv;
}

FStar_Pervasives_Native_option__CipherSuite_kexAlg
HandshakeLog___proj__State__item__kex(HandshakeLog_state projectee)
{
  return projectee.kex;
}

FStar_Pervasives_Native_option__CommonDH_group_
HandshakeLog___proj__State__item__dh_group(HandshakeLog_state projectee)
{
  return projectee.dh_group;
}

HandshakeLog_state
*HandshakeLog_create(
  FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion pv
)
{
  KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
  Prims_list__HandshakeMessages_hs_msg
  *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
  buf[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
  HandshakeLog_state
  l =
    {
      .outgoing = FStar_Bytes_empty_bytes,
      .outgoing_next_keys = { .tag = FStar_Pervasives_Native_None }, .outgoing_complete = false,
      .incoming = FStar_Bytes_empty_bytes, .parsed = buf,
      .hashes = {
        .tag = HandshakeLog_OpenHash,
        .val = { .case_OpenHash = FStar_Bytes_empty_bytes }
      }, .pv = pv, .kex = { .tag = FStar_Pervasives_Native_None },
      .dh_group = { .tag = FStar_Pervasives_Native_None }
    };
  KRML_CHECK_SIZE(sizeof (HandshakeLog_state), (uint32_t)1U);
  HandshakeLog_state *st = KRML_HOST_MALLOC(sizeof (HandshakeLog_state));
  st[0U] = l;
  return st;
}

void
HandshakeLog_setParams(
  HandshakeLog_state *l,
  Parsers_ProtocolVersion_protocolVersion pv,
  Spec_Hash_Definitions_hash_alg ha,
  FStar_Pervasives_Native_option__CipherSuite_kexAlg kexo,
  FStar_Pervasives_Native_option__CommonDH_group_ dho
)
{
  HandshakeLog_state st = l[0U];
  if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes msgs = st.hashes.val.case_OpenHash;
    FStar_Bytes_bytes acc = Hashing_start(ha);
    FStar_Bytes_bytes acc1 = Hashing_extend(ha, acc, msgs);
    KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
    Prims_list__FStar_Bytes_bytes *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
    buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
    HandshakeLog_hashState
    hs =
      {
        .tag = HandshakeLog_FixedHash,
        .val = { .case_FixedHash = { .a = ha, .state = acc1, .hashes = buf } }
      };
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = st.outgoing,
          .outgoing_next_keys = st.outgoing_next_keys,
          .outgoing_complete = st.outgoing_complete,
          .incoming = st.incoming,
          .parsed = st.parsed,
          .hashes = hs,
          .pv = { .tag = FStar_Pervasives_Native_Some, .v = pv },
          .kex = kexo,
          .dh_group = dho
        }
      );
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

void
HandshakeLog_load_stateless_cookie(
  HandshakeLog_state *l,
  HandshakeMessages_hrr hrr,
  FStar_Bytes_bytes digest
)
{
  HandshakeLog_state st = l[0U];
  if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes ch2b = st.hashes.val.case_OpenHash;
    FStar_Bytes_bytes
    fake_ch =
      FStar_Bytes_append(FStar_Bytes_bytes_of_hex("fe0000"),
        Parse_vlbytes((krml_checked_int_t)1, digest));
    HandshakeLog_print(Prims_strcat("Installing prefix to transcript: ",
        FStar_Bytes_hex_of_bytes(fake_ch)));
    FStar_Bytes_bytes
    hrb =
      HandshakeMessages_handshakeMessageBytes((
          (FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion){
            .tag = FStar_Pervasives_Native_None
          }
        ),
        (
          (HandshakeMessages_hs_msg){
            .tag = HandshakeMessages_HelloRetryRequest,
            .val = { .case_HelloRetryRequest = hrr }
          }
        ));
    HandshakeLog_print(Prims_strcat("HRR bytes: ", FStar_Bytes_hex_of_bytes(hrb)));
    HandshakeLog_hashState
    h1 =
      {
        .tag = HandshakeLog_OpenHash,
        .val = { .case_OpenHash = FStar_Bytes_append(fake_ch, FStar_Bytes_append(hrb, ch2b)) }
      };
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = st.outgoing,
          .outgoing_next_keys = st.outgoing_next_keys,
          .outgoing_complete = st.outgoing_complete,
          .incoming = st.incoming,
          .parsed = st.parsed,
          .hashes = h1,
          .pv = st.pv,
          .kex = st.kex,
          .dh_group = st.dh_group
        }
      );
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

void HandshakeLog_send(HandshakeLog_state *l, HandshakeMessages_hs_msg m)
{
  HandshakeLog_print(Prims_strcat("emit ", HandshakeMessages_string_of_handshakeMessage(m)));
  HandshakeLog_state st = l[0U];
  FStar_Bytes_bytes mb = HandshakeMessages_handshakeMessageBytes(st.pv, m);
  HandshakeLog_hashState h1;
  if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    Prims_list__FStar_Bytes_bytes *hl = st.hashes.val.case_FixedHash.hashes;
    FStar_Bytes_bytes acc = st.hashes.val.case_FixedHash.state;
    Spec_Hash_Definitions_hash_alg a = st.hashes.val.case_FixedHash.a;
    FStar_Bytes_bytes acc1 = Hashing_extend(a, acc, mb);
    h1 =
      (
        (HandshakeLog_hashState){
          .tag = HandshakeLog_FixedHash,
          .val = { .case_FixedHash = { .a = a, .state = acc1, .hashes = hl } }
        }
      );
  }
  else if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes p1 = st.hashes.val.case_OpenHash;
    if (m.tag == HandshakeMessages_HelloRetryRequest)
    {
      HandshakeMessages_hrr hrr = m.val.case_HelloRetryRequest;
      FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut0;
      if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_NULL_WITH_NULL_NULL)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = { .tag = CipherSuite_NullCipherSuite }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite13,
                .val = {
                  .case_CipherSuite13 = {
                    ._0 = EverCrypt_AES128_GCM,
                    ._1 = Spec_Hash_Definitions_SHA2_256
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite13,
                .val = {
                  .case_CipherSuite13 = {
                    ._0 = EverCrypt_AES256_GCM,
                    ._1 = Spec_Hash_Definitions_SHA2_384
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite13,
                .val = {
                  .case_CipherSuite13 = {
                    ._0 = EverCrypt_CHACHA20_POLY1305,
                    ._1 = Spec_Hash_Definitions_SHA2_256
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_CCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite13,
                .val = {
                  .case_CipherSuite13 = {
                    ._0 = EverCrypt_AES128_CCM,
                    ._1 = Spec_Hash_Definitions_SHA2_256
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_CCM_8_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite13,
                .val = {
                  .case_CipherSuite13 = {
                    ._0 = EverCrypt_AES128_CCM8,
                    ._1 = Spec_Hash_Definitions_SHA2_256
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_MD5)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MACOnly,
                      .val = { .case_MACOnly = Spec_Hash_Definitions_MD5 }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MACOnly,
                      .val = { .case_MACOnly = Spec_Hash_Definitions_SHA1 }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MACOnly,
                      .val = { .case_MACOnly = Spec_Hash_Definitions_SHA2_256 }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_MD5)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Stream,
                            .val = { .case_Stream = EverCrypt_RC4_128 }
                          },
                          ._1 = Spec_Hash_Definitions_MD5
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Stream,
                            .val = { .case_Stream = EverCrypt_RC4_128 }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_3DES_EDE_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_RC4_128_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Stream,
                            .val = { .case_Stream = EverCrypt_RC4_128 }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_RC4_128_MD5)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Stream,
                            .val = { .case_Stream = EverCrypt_RC4_128 }
                          },
                          ._1 = Spec_Hash_Definitions_MD5
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_3DES_EDE_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA1
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES128_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_MtE,
                      .val = {
                        .case_MtE = {
                          ._0 = {
                            .tag = CipherSuite_Block,
                            .val = { .case_Block = EverCrypt_AES256_CBC }
                          },
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_RSA,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DH,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DH,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DH,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DH,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_GCM_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES128_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_GCM_SHA384)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_AES256_GCM,
                          ._1 = Spec_Hash_Definitions_SHA2_384
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (
        hrr.hrr_cipher_suite.tag
        == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
      )
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_PSK_WITH_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_PSK,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_PSK_ECDHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else if
      (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256)
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .tag = CipherSuite_CipherSuite,
                .val = {
                  .case_CipherSuite = {
                    ._0 = CipherSuite_Kex_PSK_DHE,
                    ._1 = { .tag = FStar_Pervasives_Native_None },
                    ._2 = {
                      .tag = CipherSuite_AEAD,
                      .val = {
                        .case_AEAD = {
                          ._0 = EverCrypt_CHACHA20_POLY1305,
                          ._1 = Spec_Hash_Definitions_SHA2_256
                        }
                      }
                    }
                  }
                }
              }
            }
          );
      else
        scrut0 =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_None
            }
          );
      FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut;
      if (scrut0.tag == FStar_Pervasives_Native_Some)
      {
        CipherSuite_cipherSuite_ v1 = scrut0.v;
        scrut =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_Some,
              .v = v1
            }
          );
      }
      else if (scrut0.tag == FStar_Pervasives_Native_None)
        scrut =
          (
            (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
              .tag = FStar_Pervasives_Native_None
            }
          );
      else
        scrut =
          KRML_EABORT(FStar_Pervasives_Native_option__CipherSuite_cipherSuite_,
            "unreachable (pattern matches are exhaustive in F*)");
      if (scrut.tag == FStar_Pervasives_Native_Some)
      {
        CipherSuite_cipherSuite_ cs = scrut.v;
        FStar_Bytes_bytes
        hmsg = Hashing_compute(TLSConstants_verifyDataHashAlg_of_ciphersuite(cs), p1);
        FStar_Bytes_bytes
        hht =
          FStar_Bytes_append(FStar_Bytes_bytes_of_hex("fe0000"),
            FStar_Bytes_append(FStar_Bytes_bytes_of_int((krml_checked_int_t)1,
                FStar_UInt32_v(FStar_Bytes_len(hmsg))),
              hmsg));
        h1 =
          (
            (HandshakeLog_hashState){
              .tag = HandshakeLog_OpenHash,
              .val = { .case_OpenHash = FStar_Bytes_append(hht, mb) }
            }
          );
      }
      else
        h1 =
          KRML_EABORT(HandshakeLog_hashState,
            "unreachable (pattern matches are exhaustive in F*)");
    }
    else
      h1 =
        (
          (HandshakeLog_hashState){
            .tag = HandshakeLog_OpenHash,
            .val = { .case_OpenHash = FStar_Bytes_append(p1, mb) }
          }
        );
  }
  else
    h1 = KRML_EABORT(HandshakeLog_hashState, "unreachable (pattern matches are exhaustive in F*)");
  FStar_Bytes_bytes o = FStar_Bytes_append(st.outgoing, mb);
  l[0U] =
    (
      (HandshakeLog_state){
        .outgoing = o,
        .outgoing_next_keys = st.outgoing_next_keys,
        .outgoing_complete = st.outgoing_complete,
        .incoming = st.incoming,
        .parsed = st.parsed,
        .hashes = h1,
        .pv = st.pv,
        .kex = st.kex,
        .dh_group = st.dh_group
      }
    );
}

FStar_Bytes_bytes
HandshakeLog_hash_tag(Spec_Hash_Definitions_hash_alg a, HandshakeLog_state *l)
{
  HandshakeLog_state st = l[0U];
  if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    FStar_Bytes_bytes acc = st.hashes.val.case_FixedHash.state;
    Spec_Hash_Definitions_hash_alg a_ = st.hashes.val.case_FixedHash.a;
    if (__neq__Spec_Hash_Definitions_hash_alg(a, a_))
      HandshakeLog_print("BAD HASH (statically excluded)");
    return Hashing_finalize(a, acc);
  }
  else if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes b = st.hashes.val.case_OpenHash;
    return Hashing_compute(a, b);
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Bytes_bytes
HandshakeLog_hash_tag_truncated(
  Spec_Hash_Definitions_hash_alg a,
  HandshakeLog_state *l,
  Prims_int len1
)
{
  HandshakeLog_state st = l[0U];
  if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    HandshakeLog_print("BAD HASH (statically excluded)");
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n", __FILE__, __LINE__, "");
    KRML_HOST_EXIT(255U);
  }
  else if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes b = st.hashes.val.case_OpenHash;
    return
      Hashing_compute(a,
        FStar_Pervasives_Native_fst__FStar_Bytes_bytes_FStar_Bytes_bytes(FStar_Bytes_split(b,
            FStar_UInt32_uint_to_t(Prims_op_Subtraction(FStar_UInt32_v(FStar_Bytes_len(b)), len1)))));
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct K___HandshakeLog_hashState_FStar_Bytes_bytes_s
{
  HandshakeLog_hashState fst;
  FStar_Bytes_bytes snd;
}
K___HandshakeLog_hashState_FStar_Bytes_bytes;

FStar_Bytes_bytes
HandshakeLog_send_tag(
  Spec_Hash_Definitions_hash_alg a,
  HandshakeLog_state *l,
  HandshakeMessages_hs_msg m
)
{
  HandshakeLog_print(Prims_strcat("emit ",
      Prims_strcat(HandshakeMessages_string_of_handshakeMessage(m), " and hash")));
  HandshakeLog_state st = l[0U];
  FStar_Bytes_bytes mb = HandshakeMessages_handshakeMessageBytes(st.pv, m);
  K___HandshakeLog_hashState_FStar_Bytes_bytes uu____0;
  if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    Prims_list__FStar_Bytes_bytes *hl = st.hashes.val.case_FixedHash.hashes;
    FStar_Bytes_bytes acc = st.hashes.val.case_FixedHash.state;
    FStar_Bytes_bytes acc1 = Hashing_extend(a, acc, mb);
    FStar_Bytes_bytes tg = Hashing_finalize(a, acc1);
    uu____0 =
      (
        (K___HandshakeLog_hashState_FStar_Bytes_bytes){
          .fst = {
            .tag = HandshakeLog_FixedHash,
            .val = { .case_FixedHash = { .a = a, .state = acc1, .hashes = hl } }
          },
          .snd = tg
        }
      );
  }
  else if (st.hashes.tag == HandshakeLog_OpenHash)
  {
    FStar_Bytes_bytes b = st.hashes.val.case_OpenHash;
    FStar_Bytes_bytes b1 = FStar_Bytes_append(b, mb);
    uu____0 =
      (
        (K___HandshakeLog_hashState_FStar_Bytes_bytes){
          .fst = { .tag = HandshakeLog_OpenHash, .val = { .case_OpenHash = b1 } },
          .snd = Hashing_compute(a, b1)
        }
      );
  }
  else
    uu____0 =
      KRML_EABORT(K___HandshakeLog_hashState_FStar_Bytes_bytes,
        "unreachable (pattern matches are exhaustive in F*)");
  HandshakeLog_hashState h1 = uu____0.fst;
  FStar_Bytes_bytes tg = uu____0.snd;
  FStar_Bytes_bytes o = FStar_Bytes_append(st.outgoing, mb);
  l[0U] =
    (
      (HandshakeLog_state){
        .outgoing = o,
        .outgoing_next_keys = st.outgoing_next_keys,
        .outgoing_complete = st.outgoing_complete,
        .incoming = st.incoming,
        .parsed = st.parsed,
        .hashes = h1,
        .pv = st.pv,
        .kex = st.kex,
        .dh_group = st.dh_group
      }
    );
  return tg;
}

FStar_Bytes_bytes
HandshakeLog_send_CCS_tag(
  Spec_Hash_Definitions_hash_alg a,
  HandshakeLog_state *l,
  HandshakeMessages_hs_msg m,
  bool cf
)
{
  HandshakeLog_state st = l[0U];
  FStar_Bytes_bytes mb = HandshakeMessages_handshakeMessageBytes(st.pv, m);
  K___HandshakeLog_hashState_FStar_Bytes_bytes uu____0;
  if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    Prims_list__FStar_Bytes_bytes *hl = st.hashes.val.case_FixedHash.hashes;
    FStar_Bytes_bytes acc = st.hashes.val.case_FixedHash.state;
    Spec_Hash_Definitions_hash_alg a1 = st.hashes.val.case_FixedHash.a;
    FStar_Bytes_bytes acc1 = Hashing_extend(a1, acc, mb);
    FStar_Bytes_bytes tg = Hashing_finalize(a1, acc1);
    uu____0 =
      (
        (K___HandshakeLog_hashState_FStar_Bytes_bytes){
          .fst = {
            .tag = HandshakeLog_FixedHash,
            .val = { .case_FixedHash = { .a = a1, .state = acc1, .hashes = hl } }
          },
          .snd = tg
        }
      );
  }
  else
    uu____0 =
      KRML_EABORT(K___HandshakeLog_hashState_FStar_Bytes_bytes,
        "unreachable (pattern matches are exhaustive in F*)");
  HandshakeLog_hashState h1 = uu____0.fst;
  FStar_Bytes_bytes tg = uu____0.snd;
  FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
  nk;
  if (st.outgoing_next_keys.tag == FStar_Pervasives_Native_None)
    nk =
      (
        (FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .fst = false,
            .snd = { .tag = FStar_Pervasives_Native_Some, .v = mb },
            .thd = false,
            .f3 = false
          }
        }
      );
  else
    nk =
      KRML_EABORT(FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool,
        "unreachable (pattern matches are exhaustive in F*)");
  l[0U] =
    (
      (HandshakeLog_state){
        .outgoing = st.outgoing,
        .outgoing_next_keys = nk,
        .outgoing_complete = cf,
        .incoming = st.incoming,
        .parsed = st.parsed,
        .hashes = h1,
        .pv = st.pv,
        .kex = st.kex,
        .dh_group = st.dh_group
      }
    );
  return tg;
}

static bool
__neq__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool(
  K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool y,
  K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool x
)
{
  return
    false
    || x.fst != y.fst
    || __neq__FStar_Pervasives_Native_option__FStar_Bytes_bytes(x.snd, y.snd)
    || x.thd != y.thd
    || x.f3 != y.f3;
}

static bool
__neq__FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool(
  FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
  y,
  FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
  x
)
{
  if (x.tag == FStar_Pervasives_Native_None)
    if (y.tag == FStar_Pervasives_Native_None)
      return false;
    else
      return true;
  else if (x.tag == FStar_Pervasives_Native_Some)
  {
    K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool x_v = x.v;
    if (y.tag == FStar_Pervasives_Native_Some)
    {
      K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool y_v = y.v;
      return
        false
        || __neq__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool(y_v, x_v);
    }
    else
      return true;
  }
  else
    return true;
}

void
HandshakeLog_send_signals(
  HandshakeLog_state *l,
  FStar_Pervasives_Native_option__K___bool_bool_bool next_keys1,
  bool complete1
)
{
  HandshakeLog_state scrut = l[0U];
  FStar_Bytes_bytes outgoing = scrut.outgoing;
  FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
  outgoing_next_keys0 = scrut.outgoing_next_keys;
  bool outgoing_complete0 = scrut.outgoing_complete;
  FStar_Bytes_bytes incoming = scrut.incoming;
  Prims_list__HandshakeMessages_hs_msg *parsed1 = scrut.parsed;
  HandshakeLog_hashState hashes = scrut.hashes;
  FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion pv = scrut.pv;
  FStar_Pervasives_Native_option__CipherSuite_kexAlg kex = scrut.kex;
  FStar_Pervasives_Native_option__CommonDH_group_ dh_group = scrut.dh_group;
  if
  (
    __neq__FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool(outgoing_next_keys0,
      (
        (FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool){
          .tag = FStar_Pervasives_Native_None
        }
      ))
  )
    HandshakeLog_print("WARNING: dirty next-key flag -- use send_CCS instead");
  if (outgoing_complete0)
    HandshakeLog_print("WARNING: dirty complete flag");
  FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool
  outgoing_next_keys1;
  if (next_keys1.tag == FStar_Pervasives_Native_Some)
  {
    bool reject_0rtt = next_keys1.v.thd;
    bool skip_0rtt = next_keys1.v.snd;
    bool enable_appdata = next_keys1.v.fst;
    outgoing_next_keys1 =
      (
        (FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .fst = enable_appdata,
            .snd = { .tag = FStar_Pervasives_Native_None },
            .thd = skip_0rtt,
            .f3 = reject_0rtt
          }
        }
      );
  }
  else if (next_keys1.tag == FStar_Pervasives_Native_None)
    outgoing_next_keys1 =
      (
        (FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool){
          .tag = FStar_Pervasives_Native_None
        }
      );
  else
    outgoing_next_keys1 =
      KRML_EABORT(FStar_Pervasives_Native_option__K___bool_FStar_Pervasives_Native_option__FStar_Bytes_bytes_bool_bool,
        "unreachable (pattern matches are exhaustive in F*)");
  l[0U] =
    (
      (HandshakeLog_state){
        .outgoing = outgoing,
        .outgoing_next_keys = outgoing_next_keys1,
        .outgoing_complete = complete1,
        .incoming = incoming,
        .parsed = parsed1,
        .hashes = hashes,
        .pv = pv,
        .kex = kex,
        .dh_group = dh_group
      }
    );
}

bool
HandshakeLog___proj__Mknext_keys_use__item__out_appdata(HandshakeLog_next_keys_use projectee)
{
  return projectee.out_appdata;
}

bool
HandshakeLog___proj__Mknext_keys_use__item__out_ccs_first(HandshakeLog_next_keys_use projectee)
{
  return projectee.out_ccs_first;
}

bool
HandshakeLog___proj__Mknext_keys_use__item__out_skip_0RTT(HandshakeLog_next_keys_use projectee)
{
  return projectee.out_skip_0RTT;
}

bool
HandshakeLog___proj__Mknext_keys_use__item__out_0RTT_reject(
  HandshakeLog_next_keys_use projectee
)
{
  return projectee.out_0RTT_reject;
}

bool HandshakeLog_uu___is_Outgoing(TLSInfo_id i1, HandshakeLog_outgoing projectee)
{
  return true;
}

FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes
HandshakeLog___proj__Outgoing__item__send_first(TLSInfo_id i1, HandshakeLog_outgoing projectee)
{
  return projectee.send_first;
}

FStar_Pervasives_Native_option__HandshakeLog_next_keys_use
HandshakeLog___proj__Outgoing__item__next_keys(TLSInfo_id i1, HandshakeLog_outgoing projectee)
{
  return projectee.next_keys;
}

bool
HandshakeLog___proj__Outgoing__item__complete(TLSInfo_id i1, HandshakeLog_outgoing projectee)
{
  return projectee.complete;
}

Prims_int HandshakeLog_to_be_written(HandshakeLog_state *l)
{
  HandshakeLog_state st = l[0U];
  return FStar_UInt32_v(FStar_Bytes_len(st.outgoing));
}

typedef struct
K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes_s
{
  FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes fst;
  FStar_Bytes_bytes snd;
}
K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes;

typedef struct
K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes_s
{
  FStar_Pervasives_Native_option__HandshakeLog_next_keys_use fst;
  FStar_Bytes_bytes snd;
}
K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes;

HandshakeLog_outgoing
HandshakeLog_write_at_most(HandshakeLog_state *l, TLSInfo_id i1, Prims_int max1)
{
  HandshakeLog_state st = l[0U];
  FStar_Bytes_bytes o = st.outgoing;
  Prims_int lo = FStar_UInt32_v(FStar_Bytes_len(o));
  K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes
  scrut0;
  if (lo == (krml_checked_int_t)0)
    scrut0 =
      (
        (K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes){
          .fst = { .tag = FStar_Pervasives_Native_None },
          .snd = FStar_Bytes_empty_bytes
        }
      );
  else if (Prims_op_LessThanOrEqual(lo, max1))
  {
    K___Prims_int_Prims_int rg = { .fst = lo, .snd = lo };
    scrut0 =
      (
        (K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes){
          .fst = { .tag = FStar_Pervasives_Native_Some, .v = { .fst = rg, .snd = o } },
          .snd = FStar_Bytes_empty_bytes
        }
      );
  }
  else
  {
    K___FStar_Bytes_bytes_FStar_Bytes_bytes
    scrut = FStar_Bytes_split(o, FStar_UInt32_uint_to_t(max1));
    FStar_Bytes_bytes x = scrut.fst;
    FStar_Bytes_bytes y = scrut.snd;
    Prims_int lx = FStar_UInt32_v(FStar_Bytes_len(x));
    K___Prims_int_Prims_int rg = { .fst = lx, .snd = lx };
    scrut0 =
      (
        (K___FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes_FStar_Bytes_bytes){
          .fst = { .tag = FStar_Pervasives_Native_Some, .v = { .fst = rg, .snd = x } },
          .snd = y
        }
      );
  }
  FStar_Pervasives_Native_option__Prims_dtuple2__K___Prims_int_Prims_int_FStar_Bytes_bytes
  fragment = scrut0.fst;
  FStar_Bytes_bytes outgoing_ = scrut0.snd;
  if
  (
    FStar_UInt32_v(FStar_Bytes_len(outgoing_))
    == (krml_checked_int_t)0
    || max1 == (krml_checked_int_t)0
  )
  {
    K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes scrut;
    if
    (
      st.outgoing_next_keys.tag
      == FStar_Pervasives_Native_Some
      && st.outgoing_next_keys.v.snd.tag == FStar_Pervasives_Native_Some
    )
    {
      bool rz = st.outgoing_next_keys.v.f3;
      bool z = st.outgoing_next_keys.v.thd;
      FStar_Bytes_bytes finishedFragment = st.outgoing_next_keys.v.snd.v;
      bool a = st.outgoing_next_keys.v.fst;
      if (a || z)
        HandshakeLog_print("unexpected 1.2 signals");
      scrut =
        (
          (K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes){
            .fst = {
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .out_appdata = a,
                .out_ccs_first = true,
                .out_skip_0RTT = z,
                .out_0RTT_reject = rz
              }
            },
            .snd = finishedFragment
          }
        );
    }
    else if
    (
      st.outgoing_next_keys.tag
      == FStar_Pervasives_Native_Some
      && st.outgoing_next_keys.v.snd.tag == FStar_Pervasives_Native_None
    )
    {
      bool rz = st.outgoing_next_keys.v.f3;
      bool z = st.outgoing_next_keys.v.thd;
      bool a = st.outgoing_next_keys.v.fst;
      scrut =
        (
          (K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes){
            .fst = {
              .tag = FStar_Pervasives_Native_Some,
              .v = {
                .out_appdata = a,
                .out_ccs_first = false,
                .out_skip_0RTT = z,
                .out_0RTT_reject = rz
              }
            },
            .snd = outgoing_
          }
        );
    }
    else if (st.outgoing_next_keys.tag == FStar_Pervasives_Native_None)
      scrut =
        (
          (K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes){
            .fst = { .tag = FStar_Pervasives_Native_None },
            .snd = outgoing_
          }
        );
    else
      scrut =
        KRML_EABORT(K___FStar_Pervasives_Native_option__HandshakeLog_next_keys_use_FStar_Bytes_bytes,
          "unreachable (pattern matches are exhaustive in F*)");
    FStar_Pervasives_Native_option__HandshakeLog_next_keys_use next_keys1 = scrut.fst;
    FStar_Bytes_bytes outgoing1 = scrut.snd;
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = outgoing1,
          .outgoing_next_keys = { .tag = FStar_Pervasives_Native_None },
          .outgoing_complete = false,
          .incoming = st.incoming,
          .parsed = st.parsed,
          .hashes = st.hashes,
          .pv = st.pv,
          .kex = st.kex,
          .dh_group = st.dh_group
        }
      );
    return
      (
        (HandshakeLog_outgoing){
          .send_first = fragment,
          .next_keys = next_keys1,
          .complete = st.outgoing_complete
        }
      );
  }
  else
  {
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = outgoing_,
          .outgoing_next_keys = st.outgoing_next_keys,
          .outgoing_complete = st.outgoing_complete,
          .incoming = st.incoming,
          .parsed = st.parsed,
          .hashes = st.hashes,
          .pv = st.pv,
          .kex = st.kex,
          .dh_group = st.dh_group
        }
      );
    return
      (
        (HandshakeLog_outgoing){
          .send_first = fragment,
          .next_keys = { .tag = FStar_Pervasives_Native_None },
          .complete = false
        }
      );
  }
}

HandshakeLog_outgoing HandshakeLog_next_fragment(HandshakeLog_state *l, TLSInfo_id i1)
{
  return HandshakeLog_write_at_most(l, i1, TLSConstants_max_TLSPlaintext_fragment_length);
}

typedef struct
K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_s
{
  bool fst;
  FStar_Bytes_bytes snd;
  Prims_list__HandshakeMessages_hs_msg *thd;
  Prims_list__FStar_Bytes_bytes *f3;
}
K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes;

typedef struct
FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_s
{
  FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___FStar_Bytes_bytes_FStar_Bytes_bytes_tags
  tag;
  union {
    K___Parsers_Alert_alert_Prims_string case_Error;
    K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
    case_Correct;
  }
  val;
}
FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes;

static bool
__eq__HandshakeMessages_handshakeType(
  HandshakeMessages_handshakeType y,
  HandshakeMessages_handshakeType x
)
{
  switch (x)
  {
    case HandshakeMessages_HT_hello_request:
      {
        switch (y)
        {
          case HandshakeMessages_HT_hello_request:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_client_hello:
      {
        switch (y)
        {
          case HandshakeMessages_HT_client_hello:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_server_hello:
      {
        switch (y)
        {
          case HandshakeMessages_HT_server_hello:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_session_ticket:
      {
        switch (y)
        {
          case HandshakeMessages_HT_session_ticket:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_end_of_early_data:
      {
        switch (y)
        {
          case HandshakeMessages_HT_end_of_early_data:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_hello_retry_request:
      {
        switch (y)
        {
          case HandshakeMessages_HT_hello_retry_request:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_encrypted_extensions:
      {
        switch (y)
        {
          case HandshakeMessages_HT_encrypted_extensions:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_certificate:
      {
        switch (y)
        {
          case HandshakeMessages_HT_certificate:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_server_key_exchange:
      {
        switch (y)
        {
          case HandshakeMessages_HT_server_key_exchange:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_certificate_request:
      {
        switch (y)
        {
          case HandshakeMessages_HT_certificate_request:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_server_hello_done:
      {
        switch (y)
        {
          case HandshakeMessages_HT_server_hello_done:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_certificate_verify:
      {
        switch (y)
        {
          case HandshakeMessages_HT_certificate_verify:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_client_key_exchange:
      {
        switch (y)
        {
          case HandshakeMessages_HT_client_key_exchange:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_finished:
      {
        switch (y)
        {
          case HandshakeMessages_HT_finished:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_key_update:
      {
        switch (y)
        {
          case HandshakeMessages_HT_key_update:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    case HandshakeMessages_HT_message_hash:
      {
        switch (y)
        {
          case HandshakeMessages_HT_message_hash:
            {
              return true;
            }
          default:
            {
              return false;
            }
        }
        break;
      }
    default:
      {
        return false;
      }
  }
}

static FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
HandshakeLog_parseMessages(
  FStar_Pervasives_Native_option__Parsers_ProtocolVersion_protocolVersion pvo,
  FStar_Pervasives_Native_option__CipherSuite_kexAlg kexo,
  FStar_Bytes_bytes buf1
)
{
  FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__FStar_Pervasives_dtuple4__FStar_Bytes_bytes_HandshakeMessages_handshakeType_FStar_Bytes_bytes_FStar_Bytes_bytes
  scrut0 = HandshakeMessages_parseMessage(buf1);
  if (scrut0.tag == FStar_Error_Error)
  {
    K___Parsers_Alert_alert_Prims_string z = scrut0.val.case_Error;
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
          .tag = FStar_Error_Error,
          .val = { .case_Error = z }
        }
      );
  }
  else if
  (
    scrut0.tag
    == FStar_Error_Correct
    && scrut0.val.case_Correct.tag == FStar_Pervasives_Native_None
  )
  {
    HandshakeLog_print("more bytes required");
    KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
    Prims_list__HandshakeMessages_hs_msg
    *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
    buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
    KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
    Prims_list__FStar_Bytes_bytes *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
    buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = { .fst = false, .snd = buf1, .thd = buf0, .f3 = buf } }
        }
      );
  }
  else if
  (
    scrut0.tag
    == FStar_Error_Correct
    && scrut0.val.case_Correct.tag == FStar_Pervasives_Native_Some
  )
  {
    FStar_Bytes_bytes to_log = scrut0.val.case_Correct.v._4;
    FStar_Bytes_bytes pl = scrut0.val.case_Correct.v._3;
    HandshakeMessages_handshakeType hstype = scrut0.val.case_Correct.v._2;
    FStar_Bytes_bytes rem1 = scrut0.val.case_Correct.v._1;
    if (__eq__HandshakeMessages_handshakeType(hstype, HandshakeMessages_HT_client_hello))
    {
      FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___HandshakeMessages_ch_FStar_Pervasives_Native_option__Prims_list__FStar_Bytes_bytes
      scrut = HandshakeMessages_parseClientHello(pl);
      if (scrut.tag == FStar_Error_Error)
      {
        K___Parsers_Alert_alert_Prims_string z = scrut.val.case_Error;
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
              .tag = FStar_Error_Error,
              .val = { .case_Error = z }
            }
          );
      }
      else if
      (
        scrut.tag
        == FStar_Error_Correct
        && scrut.val.case_Correct.snd.tag == FStar_Pervasives_Native_None
      )
      {
        HandshakeMessages_ch ch = scrut.val.case_Correct.fst;
        Prims_string ite;
        if (Prims_op_GreaterThan(FStar_UInt32_v(FStar_Bytes_len(rem1)), (krml_checked_int_t)0))
          ite = " (bytes waiting)";
        else
          ite = "";
        HandshakeLog_print(Prims_strcat("parsed [ClientHello] -- end of flight ", ite));
        KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
        Prims_list__HandshakeMessages_hs_msg
        *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
        buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
        KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
        Prims_list__HandshakeMessages_hs_msg
        *buf1 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
        buf1[0U]
        =
          (
            (Prims_list__HandshakeMessages_hs_msg){
              .tag = Prims_Cons,
              .hd = { .tag = HandshakeMessages_ClientHello, .val = { .case_ClientHello = ch } },
              .tl = buf0
            }
          );
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf2 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf2[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = to_log, .tl = buf });
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = { .fst = true, .snd = rem1, .thd = buf1, .f3 = buf2 } }
            }
          );
      }
      else if
      (
        scrut.tag
        == FStar_Error_Correct
        && scrut.val.case_Correct.snd.tag == FStar_Pervasives_Native_Some
      )
      {
        Prims_list__FStar_Bytes_bytes *binders = scrut.val.case_Correct.snd.v;
        HandshakeMessages_ch ch = scrut.val.case_Correct.fst;
        Prims_string ite;
        if (Prims_op_GreaterThan(FStar_UInt32_v(FStar_Bytes_len(rem1)), (krml_checked_int_t)0))
          ite = " (bytes waiting)";
        else
          ite = "";
        HandshakeLog_print(Prims_strcat("parsed [ClientHello; Binders] -- end of flight ", ite));
        K___FStar_Bytes_bytes_FStar_Bytes_bytes
        scrut =
          FStar_Bytes_split(to_log,
            FStar_UInt32_uint_to_t(Prims_op_Subtraction(FStar_UInt32_v(FStar_Bytes_len(to_log)),
                HandshakeMessages_bindersLen_of_ch(ch))));
        FStar_Bytes_bytes chBytes = scrut.fst;
        FStar_Bytes_bytes bindersBytes1 = scrut.snd;
        KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
        Prims_list__HandshakeMessages_hs_msg
        *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
        buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
        KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
        Prims_list__HandshakeMessages_hs_msg
        *buf1 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
        buf1[0U]
        =
          (
            (Prims_list__HandshakeMessages_hs_msg){
              .tag = Prims_Cons,
              .hd = { .tag = HandshakeMessages_Binders, .val = { .case_Binders = binders } },
              .tl = buf0
            }
          );
        KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
        Prims_list__HandshakeMessages_hs_msg
        *buf2 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
        buf2[0U]
        =
          (
            (Prims_list__HandshakeMessages_hs_msg){
              .tag = Prims_Cons,
              .hd = { .tag = HandshakeMessages_ClientHello, .val = { .case_ClientHello = ch } },
              .tl = buf1
            }
          );
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf3 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf3[0U]
        = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = bindersBytes1, .tl = buf });
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf4 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf4[0U]
        = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = chBytes, .tl = buf3 });
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = { .fst = true, .snd = rem1, .thd = buf2, .f3 = buf4 } }
            }
          );
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_HandshakeMessages_hs_msg
      scrut0 = HandshakeMessages_parseHandshakeMessage(pvo, kexo, hstype, pl);
      if (scrut0.tag == FStar_Error_Error)
      {
        K___Parsers_Alert_alert_Prims_string z = scrut0.val.case_Error;
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
              .tag = FStar_Error_Error,
              .val = { .case_Error = z }
            }
          );
      }
      else if (scrut0.tag == FStar_Error_Correct)
      {
        HandshakeMessages_hs_msg msg = scrut0.val.case_Correct;
        HandshakeLog_print(Prims_strcat("parsed ",
            HandshakeMessages_string_of_handshakeMessage(msg)));
        if (HandshakeLog_eoflight(msg))
        {
          Prims_string ite;
          if (Prims_op_GreaterThan(FStar_UInt32_v(FStar_Bytes_len(rem1)), (krml_checked_int_t)0))
            ite = " (bytes waiting)";
          else
            ite = "";
          HandshakeLog_print(Prims_strcat("end of flight", ite));
          KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
          Prims_list__HandshakeMessages_hs_msg
          *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
          buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
          Prims_list__HandshakeMessages_hs_msg
          *buf1 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
          buf1[0U]
          = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Cons, .hd = msg, .tl = buf0 });
          KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
          Prims_list__FStar_Bytes_bytes
          *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
          buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
          Prims_list__FStar_Bytes_bytes
          *buf2 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
          buf2[0U]
          = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = to_log, .tl = buf });
          return
            (
              (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
                .tag = FStar_Error_Correct,
                .val = { .case_Correct = { .fst = true, .snd = rem1, .thd = buf1, .f3 = buf2 } }
              }
            );
        }
        else
        {
          FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
          scrut = HandshakeLog_parseMessages(pvo, kexo, rem1);
          if (scrut.tag == FStar_Error_Error)
          {
            K___Parsers_Alert_alert_Prims_string z = scrut.val.case_Error;
            return
              (
                (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
                  .tag = FStar_Error_Error,
                  .val = { .case_Error = z }
                }
              );
          }
          else if (scrut.tag == FStar_Error_Correct)
          {
            Prims_list__FStar_Bytes_bytes *bl = scrut.val.case_Correct.f3;
            Prims_list__HandshakeMessages_hs_msg *hl = scrut.val.case_Correct.thd;
            FStar_Bytes_bytes r = scrut.val.case_Correct.snd;
            bool b = scrut.val.case_Correct.fst;
            KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
            Prims_list__HandshakeMessages_hs_msg
            *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
            buf0[0U]
            = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Cons, .hd = msg, .tl = hl });
            KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
            Prims_list__FStar_Bytes_bytes
            *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
            buf[0U]
            = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = to_log, .tl = bl });
            return
              (
                (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
                  .tag = FStar_Error_Correct,
                  .val = { .case_Correct = { .fst = b, .snd = r, .thd = buf0, .f3 = buf } }
                }
              );
          }
          else
          {
            KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
              __FILE__,
              __LINE__,
              "unreachable (pattern matches are exhaustive in F*)");
            KRML_HOST_EXIT(255U);
          }
        }
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

static HandshakeLog_hashState
HandshakeLog_hashHandshakeMessages(
  Prims_list__HandshakeMessages_hs_msg *p1,
  HandshakeLog_hashState hs,
  Prims_list__HandshakeMessages_hs_msg *n1,
  Prims_list__FStar_Bytes_bytes *nb
)
{
  K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
  scrut0 = { .fst = n1, .snd = nb };
  if (scrut0.fst->tag == Prims_Nil && scrut0.snd->tag == Prims_Nil)
    return hs;
  else if (scrut0.fst->tag == Prims_Cons && scrut0.snd->tag == Prims_Cons)
  {
    Prims_list__FStar_Bytes_bytes *brest = scrut0.snd->tl;
    FStar_Bytes_bytes mb = scrut0.snd->hd;
    Prims_list__HandshakeMessages_hs_msg *mrest = scrut0.fst->tl;
    HandshakeMessages_hs_msg m = scrut0.fst->hd;
    if (hs.tag == HandshakeLog_OpenHash)
    {
      FStar_Bytes_bytes b = hs.val.case_OpenHash;
      HandshakeLog_hashState hs1;
      if (m.tag == HandshakeMessages_HelloRetryRequest)
      {
        HandshakeMessages_hrr hrr = m.val.case_HelloRetryRequest;
        FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut0;
        if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_NULL_WITH_NULL_NULL)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = { .tag = CipherSuite_NullCipherSuite }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite13,
                  .val = {
                    .case_CipherSuite13 = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite13,
                  .val = {
                    .case_CipherSuite13 = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_CHACHA20_POLY1305_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite13,
                  .val = {
                    .case_CipherSuite13 = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_CCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite13,
                  .val = {
                    .case_CipherSuite13 = {
                      ._0 = EverCrypt_AES128_CCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_AES_128_CCM_8_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite13,
                  .val = {
                    .case_CipherSuite13 = {
                      ._0 = EverCrypt_AES128_CCM8,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_MD5)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MACOnly,
                        .val = { .case_MACOnly = Spec_Hash_Definitions_MD5 }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MACOnly,
                        .val = { .case_MACOnly = Spec_Hash_Definitions_SHA1 }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MACOnly,
                        .val = { .case_MACOnly = Spec_Hash_Definitions_SHA2_256 }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_MD5)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Stream,
                              .val = { .case_Stream = EverCrypt_RC4_128 }
                            },
                            ._1 = Spec_Hash_Definitions_MD5
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Stream,
                              .val = { .case_Stream = EverCrypt_RC4_128 }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_3DES_EDE_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_RC4_128_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Stream,
                              .val = { .case_Stream = EverCrypt_RC4_128 }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_RC4_128_MD5)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Stream,
                              .val = { .case_Stream = EverCrypt_RC4_128 }
                            },
                            ._1 = Spec_Hash_Definitions_MD5
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_3DES_EDE_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA1
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES128_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_MtE,
                        .val = {
                          .case_MtE = {
                            ._0 = {
                              .tag = CipherSuite_Block,
                              .val = { .case_Block = EverCrypt_AES256_CBC }
                            },
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_RSA,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DH,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DH,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DH,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DH,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_GCM_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES128_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_GCM_SHA384)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_AES256_GCM,
                            ._1 = Spec_Hash_Definitions_SHA2_384
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (
          hrr.hrr_cipher_suite.tag
          == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256
        )
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (
          hrr.hrr_cipher_suite.tag
          == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256
        )
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_PSK_WITH_CHACHA20_POLY1305_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_PSK,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (
          hrr.hrr_cipher_suite.tag
          == Parsers_CipherSuite_TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256
        )
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_PSK_ECDHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else if
        (hrr.hrr_cipher_suite.tag == Parsers_CipherSuite_TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256)
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = {
                  .tag = CipherSuite_CipherSuite,
                  .val = {
                    .case_CipherSuite = {
                      ._0 = CipherSuite_Kex_PSK_DHE,
                      ._1 = { .tag = FStar_Pervasives_Native_None },
                      ._2 = {
                        .tag = CipherSuite_AEAD,
                        .val = {
                          .case_AEAD = {
                            ._0 = EverCrypt_CHACHA20_POLY1305,
                            ._1 = Spec_Hash_Definitions_SHA2_256
                          }
                        }
                      }
                    }
                  }
                }
              }
            );
        else
          scrut0 =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_None
              }
            );
        FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut;
        if (scrut0.tag == FStar_Pervasives_Native_Some)
        {
          CipherSuite_cipherSuite_ v1 = scrut0.v;
          scrut =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_Some,
                .v = v1
              }
            );
        }
        else if (scrut0.tag == FStar_Pervasives_Native_None)
          scrut =
            (
              (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
                .tag = FStar_Pervasives_Native_None
              }
            );
        else
          scrut =
            KRML_EABORT(FStar_Pervasives_Native_option__CipherSuite_cipherSuite_,
              "unreachable (pattern matches are exhaustive in F*)");
        FStar_Bytes_bytes hmsg;
        if (scrut.tag == FStar_Pervasives_Native_Some)
        {
          CipherSuite_cipherSuite_ cs = scrut.v;
          hmsg = Hashing_compute(TLSConstants_verifyDataHashAlg_of_ciphersuite(cs), b);
        }
        else if (scrut.tag == FStar_Pervasives_Native_None)
          hmsg = b;
        else
          hmsg =
            KRML_EABORT(FStar_Bytes_bytes,
              "unreachable (pattern matches are exhaustive in F*)");
        FStar_Bytes_bytes
        hht =
          FStar_Bytes_append(FStar_Bytes_bytes_of_hex("fe0000"),
            Parse_vlbytes((krml_checked_int_t)1, hmsg));
        HandshakeLog_print(Prims_strcat("Replacing CH1 in transcript with ",
            FStar_Bytes_hex_of_bytes(hht)));
        HandshakeLog_print(Prims_strcat("HRR bytes: ", FStar_Bytes_hex_of_bytes(mb)));
        hs1 =
          (
            (HandshakeLog_hashState){
              .tag = HandshakeLog_OpenHash,
              .val = { .case_OpenHash = FStar_Bytes_append(hht, mb) }
            }
          );
      }
      else
        hs1 =
          (
            (HandshakeLog_hashState){
              .tag = HandshakeLog_OpenHash,
              .val = { .case_OpenHash = FStar_Bytes_append(b, mb) }
            }
          );
      KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
      Prims_list__HandshakeMessages_hs_msg
      *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
      buf[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
      KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
      Prims_list__HandshakeMessages_hs_msg
      *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
      buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Cons, .hd = m, .tl = buf });
      return
        HandshakeLog_hashHandshakeMessages(FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(p1,
            buf0),
          hs1,
          mrest,
          brest);
    }
    else if (hs.tag == HandshakeLog_FixedHash)
    {
      Prims_list__FStar_Bytes_bytes *tl1 = hs.val.case_FixedHash.hashes;
      FStar_Bytes_bytes acc = hs.val.case_FixedHash.state;
      Spec_Hash_Definitions_hash_alg a = hs.val.case_FixedHash.a;
      FStar_Bytes_bytes acc1 = Hashing_extend(a, acc, mb);
      Prims_list__FStar_Bytes_bytes *tl2;
      if (HandshakeLog_tagged(m))
      {
        FStar_Bytes_bytes t1 = Hashing_finalize(a, acc1);
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf0[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Cons, .hd = t1, .tl = buf });
        tl2 = FStar_List_Tot_Base_append__FStar_Bytes_bytes(tl1, buf0);
      }
      else
        tl2 = tl1;
      HandshakeLog_hashState
      hs1 =
        {
          .tag = HandshakeLog_FixedHash,
          .val = { .case_FixedHash = { .a = a, .state = acc1, .hashes = tl2 } }
        };
      KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
      Prims_list__HandshakeMessages_hs_msg
      *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
      buf[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
      KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
      Prims_list__HandshakeMessages_hs_msg
      *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
      buf0[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Cons, .hd = m, .tl = buf });
      return
        HandshakeLog_hashHandshakeMessages(FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(p1,
            buf0),
          hs1,
          mrest,
          brest);
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes_s
{
  HandshakeLog_hashState fst;
  Prims_list__FStar_Bytes_bytes *snd;
}
K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes;

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
HandshakeLog_receive(HandshakeLog_state *l, FStar_Bytes_bytes mb)
{
  HandshakeLog_state st = l[0U];
  FStar_Bytes_bytes ib = FStar_Bytes_append(st.incoming, mb);
  FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___bool_FStar_Bytes_bytes_Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes
  scrut = HandshakeLog_parseMessages(st.pv, st.kex, ib);
  if (scrut.tag == FStar_Error_Error)
  {
    K___Parsers_Alert_alert_Prims_string z = scrut.val.case_Error;
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
          .tag = FStar_Error_Error,
          .val = { .case_Error = z }
        }
      );
  }
  else if
  (
    scrut.tag
    == FStar_Error_Correct
    &&
      scrut.val.case_Correct.fst
      == false
      && scrut.val.case_Correct.thd->tag == Prims_Nil && scrut.val.case_Correct.f3->tag == Prims_Nil
  )
  {
    FStar_Bytes_bytes r = scrut.val.case_Correct.snd;
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = st.outgoing,
          .outgoing_next_keys = st.outgoing_next_keys,
          .outgoing_complete = st.outgoing_complete,
          .incoming = r,
          .parsed = st.parsed,
          .hashes = st.hashes,
          .pv = st.pv,
          .kex = st.kex,
          .dh_group = st.dh_group
        }
      );
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
        }
      );
  }
  else if (scrut.tag == FStar_Error_Correct)
  {
    Prims_list__FStar_Bytes_bytes *bl = scrut.val.case_Correct.f3;
    Prims_list__HandshakeMessages_hs_msg *ml = scrut.val.case_Correct.thd;
    FStar_Bytes_bytes r = scrut.val.case_Correct.snd;
    bool eof = scrut.val.case_Correct.fst;
    HandshakeLog_hashState hs = HandshakeLog_hashHandshakeMessages(st.parsed, st.hashes, ml, bl);
    Prims_list__HandshakeMessages_hs_msg
    *ml1 = FStar_List_Tot_Base_append__HandshakeMessages_hs_msg(st.parsed, ml);
    if (eof)
    {
      K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes uu____0;
      if (hs.tag == HandshakeLog_FixedHash)
      {
        Prims_list__FStar_Bytes_bytes *htl = hs.val.case_FixedHash.hashes;
        FStar_Bytes_bytes ac = hs.val.case_FixedHash.state;
        Spec_Hash_Definitions_hash_alg a = hs.val.case_FixedHash.a;
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
        uu____0 =
          (
            (K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes){
              .fst = {
                .tag = HandshakeLog_FixedHash,
                .val = { .case_FixedHash = { .a = a, .state = ac, .hashes = buf } }
              },
              .snd = htl
            }
          );
      }
      else if (hs.tag == HandshakeLog_OpenHash)
      {
        KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
        Prims_list__FStar_Bytes_bytes
        *buf = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
        buf[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
        uu____0 =
          ((K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes){ .fst = hs, .snd = buf });
      }
      else
        uu____0 =
          KRML_EABORT(K___HandshakeLog_hashState_Prims_list__FStar_Bytes_bytes,
            "unreachable (pattern matches are exhaustive in F*)");
      HandshakeLog_hashState hs1 = uu____0.fst;
      Prims_list__FStar_Bytes_bytes *tl1 = uu____0.snd;
      KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
      Prims_list__HandshakeMessages_hs_msg
      *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
      buf[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
      l[0U] =
        (
          (HandshakeLog_state){
            .outgoing = st.outgoing,
            .outgoing_next_keys = st.outgoing_next_keys,
            .outgoing_complete = st.outgoing_complete,
            .incoming = r,
            .parsed = buf,
            .hashes = hs1,
            .pv = st.pv,
            .kex = st.kex,
            .dh_group = st.dh_group
          }
        );
      return
        (
          (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
            .tag = FStar_Error_Correct,
            .val = {
              .case_Correct = {
                .tag = FStar_Pervasives_Native_Some,
                .v = { .fst = ml1, .snd = tl1 }
              }
            }
          }
        );
    }
    else
    {
      l[0U] =
        (
          (HandshakeLog_state){
            .outgoing = st.outgoing,
            .outgoing_next_keys = st.outgoing_next_keys,
            .outgoing_complete = st.outgoing_complete,
            .incoming = r,
            .parsed = ml1,
            .hashes = hs,
            .pv = st.pv,
            .kex = st.kex,
            .dh_group = st.dh_group
          }
        );
      return
        (
          (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_FStar_Pervasives_Native_option__K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes){
            .tag = FStar_Error_Correct,
            .val = { .case_Correct = { .tag = FStar_Pervasives_Native_None } }
          }
        );
    }
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_FStar_Bytes_bytes
TLSError_fatal__Prims_list_HandshakeMessages_hs_msg___Prims_list_FStar_Bytes_bytes___FStar_Bytes_bytes(
  Parsers_AlertDescription_alertDescription a,
  Prims_string s
)
{
  return
    (
      (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_FStar_Bytes_bytes){
        .tag = FStar_Error_Error,
        .val = { .case_Error = { .fst = TLSError_fatalAlert(a), .snd = s } }
      }
    );
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_FStar_Bytes_bytes
HandshakeLog_receive_CCS(Spec_Hash_Definitions_hash_alg a, HandshakeLog_state *l)
{
  HandshakeLog_state st = l[0U];
  if (Prims_op_GreaterThan(FStar_UInt32_v(FStar_Bytes_len(st.incoming)), (krml_checked_int_t)0))
  {
    HandshakeLog_print(Prims_strcat("too many bytes: ", FStar_Bytes_print_bytes(st.incoming)));
    return
      TLSError_fatal__Prims_list_HandshakeMessages_hs_msg___Prims_list_FStar_Bytes_bytes___FStar_Bytes_bytes(Parsers_AlertDescription_Unexpected_message,
        "unexpected fragment after CCS");
  }
  else if (st.hashes.tag == HandshakeLog_OpenHash)
    return
      TLSError_fatal__Prims_list_HandshakeMessages_hs_msg___Prims_list_FStar_Bytes_bytes___FStar_Bytes_bytes(Parsers_AlertDescription_Internal_error,
        "the hash is open");
  else if (st.hashes.tag == HandshakeLog_FixedHash)
  {
    Prims_list__FStar_Bytes_bytes *tl1 = st.hashes.val.case_FixedHash.hashes;
    FStar_Bytes_bytes acc = st.hashes.val.case_FixedHash.state;
    Spec_Hash_Definitions_hash_alg a1 = st.hashes.val.case_FixedHash.a;
    KRML_CHECK_SIZE(sizeof (Prims_list__FStar_Bytes_bytes), (uint32_t)1U);
    Prims_list__FStar_Bytes_bytes *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__FStar_Bytes_bytes));
    buf0[0U] = ((Prims_list__FStar_Bytes_bytes){ .tag = Prims_Nil });
    HandshakeLog_hashState
    hs_ =
      {
        .tag = HandshakeLog_FixedHash,
        .val = { .case_FixedHash = { .a = a1, .state = acc, .hashes = buf0 } }
      };
    FStar_Bytes_bytes h1 = Hashing_finalize(a1, acc);
    KRML_CHECK_SIZE(sizeof (Prims_list__HandshakeMessages_hs_msg), (uint32_t)1U);
    Prims_list__HandshakeMessages_hs_msg
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__HandshakeMessages_hs_msg));
    buf[0U] = ((Prims_list__HandshakeMessages_hs_msg){ .tag = Prims_Nil });
    l[0U] =
      (
        (HandshakeLog_state){
          .outgoing = st.outgoing,
          .outgoing_next_keys = st.outgoing_next_keys,
          .outgoing_complete = st.outgoing_complete,
          .incoming = st.incoming,
          .parsed = buf,
          .hashes = hs_,
          .pv = st.pv,
          .kex = st.kex,
          .dh_group = st.dh_group
        }
      );
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___Prims_list__HandshakeMessages_hs_msg_Prims_list__FStar_Bytes_bytes_FStar_Bytes_bytes){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = { .fst = st.parsed, .snd = tl1, .thd = h1 } }
        }
      );
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

