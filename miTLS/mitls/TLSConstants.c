/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: D:\everest\kremlin\_build\src\Kremlin.native -minimal -add-include "kremlib.h" -fnoanonymous-unions -warn-error -9-7-6@4-14-15 -fsopts --debug,yes -verbose -library EverCrypt,EverCrypt.*,Hacl.*,Interop_assumptions,Check_sha_stdcall,Sha_update_bytes_stdcall,Check_aesni_stdcall -drop MonotoneMap -drop MonotoneMapNonDep -drop FStar.Tactics.\* -drop FStar.Tactics -drop Crypto.AEAD.\* -drop Crypto.HKDF -drop Crypto.HMAC -add-include "hacks.h" -add-include "kremlin/internal/compat.h" -bundle LowParse.\*,LowParseWrappers[rename=LowParse] -bundle Format.\* -bundle EverCrypt=EverCrypt,EverCrypt.\* -bundle FStar.\*,LowStar.\*,C,C.\*[rename=Mitls_Kremlib] -bundle Parsers.\* -bundle Spec.\* -bundle Meta.\* -bundle Lib.*[rename=Hacl_Lib] -bundle Hacl.\* -bundle KDF.\*,KDF,Idx,IV,Pkg,Pkg.\*[rename=Pkg] -bundle TLSConstants=TLSConstants,QD.TLS_protocolVersion,List.Helpers -bundle Hashing=Hashing.Spec,Hashing,Hashing.CRF,HMAC,HKDF,HMAC.UFCMA -bundle Old.Handshake=Old.HMAC.UFCMA,Old.Epochs,Old.KeySchedule,Old.Handshake -bundle StatefulLHAE=AEAD_GCM,LHAEPlain,StatefulPlain,StatefulLHAE -bundle StreamAE=StreamPlain,StreamAE -bundle CommonDH=TLS.Curve25519,DHGroup,ECGroup,CommonDH -bundle Content=Content,DataStream -bundle Record=Record,StAE,Transport,StreamDeltas -bundle PMS=PMS,RSAKey,TLSPRF -bundle Crypto.Plain=Buffer.Utils,Crypto.Indexing,Crypto.Plain,Crypto.Symmetric.Bytes -bundle Flags=DebugFlags,Flags,Flag,TLSInfoFlags -bundle Vale.Stdcalls.*,Vale.Interop,Vale.Interop.*,Vale.Wrapper.X64.*[rename=Vale] -bundle Vale.Inline.X64.*[rename=Vale_Inline] -bundle Vale.*[rename=Unused2] -ldopts -L,D:/everest/MLCrypto/openssl,-lcrypto,-lssl extract/Kremlin/FStar_Pervasives_Native.krml extract/Kremlin/FStar_Pervasives.krml extract/Kremlin/FStar_Squash.krml extract/Kremlin/FStar_Classical.krml extract/Kremlin/FStar_Preorder.krml extract/Kremlin/FStar_Calc.krml extract/Kremlin/FStar_Mul.krml extract/Kremlin/FStar_Math_Lib.krml extract/Kremlin/FStar_Math_Lemmas.krml extract/Kremlin/FStar_StrongExcludedMiddle.krml extract/Kremlin/FStar_FunctionalExtensionality.krml extract/Kremlin/FStar_List_Tot_Base.krml extract/Kremlin/FStar_List_Tot_Properties.krml extract/Kremlin/FStar_List_Tot.krml extract/Kremlin/FStar_Seq_Base.krml extract/Kremlin/FStar_Seq_Properties.krml extract/Kremlin/FStar_Seq.krml extract/Kremlin/FStar_BitVector.krml extract/Kremlin/FStar_UInt.krml extract/Kremlin/FStar_UInt32.krml extract/Kremlin/FStar_UInt8.krml extract/Kremlin/FStar_Exn.krml extract/Kremlin/FStar_Set.krml extract/Kremlin/FStar_Monotonic_Witnessed.krml extract/Kremlin/FStar_Ghost.krml extract/Kremlin/FStar_ErasedLogic.krml extract/Kremlin/FStar_PropositionalExtensionality.krml extract/Kremlin/FStar_PredicateExtensionality.krml extract/Kremlin/FStar_TSet.krml extract/Kremlin/FStar_Monotonic_Heap.krml extract/Kremlin/FStar_Heap.krml extract/Kremlin/FStar_ST.krml extract/Kremlin/FStar_All.krml extract/Kremlin/Lib_LoopCombinators.krml extract/Kremlin/FStar_Int.krml extract/Kremlin/FStar_Int64.krml extract/Kremlin/FStar_Int63.krml extract/Kremlin/FStar_Int32.krml extract/Kremlin/FStar_Int16.krml extract/Kremlin/FStar_Int8.krml extract/Kremlin/FStar_UInt64.krml extract/Kremlin/FStar_UInt63.krml extract/Kremlin/FStar_UInt16.krml extract/Kremlin/FStar_Int_Cast.krml extract/Kremlin/FStar_UInt128.krml extract/Kremlin/FStar_Int_Cast_Full.krml extract/Kremlin/FStar_Int128.krml extract/Kremlin/Lib_IntTypes.krml extract/Kremlin/Lib_RawIntTypes.krml extract/Kremlin/Lib_Sequence.krml extract/Kremlin/Lib_ByteSequence.krml extract/Kremlin/Spec_Chacha20.krml extract/Kremlin/Meta_Attribute.krml extract/Kremlin/FStar_Map.krml extract/Kremlin/FStar_Monotonic_HyperHeap.krml extract/Kremlin/FStar_Monotonic_HyperStack.krml extract/Kremlin/FStar_HyperStack.krml extract/Kremlin/FStar_HyperStack_ST.krml extract/Kremlin/FStar_Universe.krml extract/Kremlin/FStar_GSet.krml extract/Kremlin/FStar_ModifiesGen.krml extract/Kremlin/FStar_Range.krml extract/Kremlin/FStar_Reflection_Types.krml extract/Kremlin/FStar_Tactics_Types.krml extract/Kremlin/FStar_Tactics_Result.krml extract/Kremlin/FStar_Tactics_Effect.krml extract/Kremlin/FStar_Reflection_Data.krml extract/Kremlin/FStar_Tactics_Builtins.krml extract/Kremlin/FStar_Reflection_Const.krml extract/Kremlin/FStar_Char.krml extract/Kremlin/FStar_List.krml extract/Kremlin/FStar_String.krml extract/Kremlin/FStar_Order.krml extract/Kremlin/FStar_Reflection_Basic.krml extract/Kremlin/FStar_Reflection_Derived.krml extract/Kremlin/FStar_Reflection_Derived_Lemmas.krml extract/Kremlin/FStar_Reflection.krml extract/Kremlin/FStar_Tactics_SyntaxHelpers.krml extract/Kremlin/FStar_Tactics_Util.krml extract/Kremlin/FStar_Reflection_Formula.krml extract/Kremlin/FStar_Tactics_Derived.krml extract/Kremlin/FStar_Tactics_Logic.krml extract/Kremlin/FStar_Tactics.krml extract/Kremlin/FStar_BigOps.krml extract/Kremlin/LowStar_Monotonic_Buffer.krml extract/Kremlin/LowStar_Buffer.krml extract/Kremlin/LowStar_BufferOps.krml extract/Kremlin/Spec_Loops.krml extract/Kremlin/C_Loops.krml extract/Kremlin/Lib_Loops.krml extract/Kremlin/FStar_Endianness.krml extract/Kremlin/LowStar_Endianness.krml extract/Kremlin/LowStar_ImmutableBuffer.krml extract/Kremlin/Lib_Buffer.krml extract/Kremlin/Lib_ByteBuffer.krml extract/Kremlin/FStar_HyperStack_All.krml extract/Kremlin/Lib_IntVector_Intrinsics.krml extract/Kremlin/Spec_GaloisField.krml extract/Kremlin/Spec_AES.krml extract/Kremlin/Lib_IntVector.krml extract/Kremlin/Hacl_Spec_Chacha20_Vec.krml extract/Kremlin/Hacl_Spec_Chacha20_Lemmas.krml extract/Kremlin/Lib_Sequence_Lemmas.krml extract/Kremlin/Hacl_Spec_Chacha20_Equiv.krml extract/Kremlin/Hacl_Impl_Chacha20_Core32xN.krml extract/Kremlin/Hacl_Impl_Chacha20_Vec.krml extract/Kremlin/Vale_Lib_Seqs_s.krml extract/Kremlin/Vale_Def_Words_s.krml extract/Kremlin/Vale_Def_Words_Four_s.krml extract/Kremlin/Vale_Def_Words_Two_s.krml extract/Kremlin/Vale_Def_Words_Seq_s.krml extract/Kremlin/Vale_Def_Opaque_s.krml extract/Kremlin/Vale_Def_Types_s.krml extract/Kremlin/Vale_X64_Machine_s.krml extract/Kremlin/Vale_Lib_Map16.krml extract/Kremlin/Vale_Def_Prop_s.krml extract/Kremlin/Vale_X64_Flags.krml extract/Kremlin/Vale_X64_CPU_Features_s.krml extract/Kremlin/Vale_Curve25519_Fast_lemmas_internal.krml extract/Kremlin/Vale_Lib_Meta.krml extract/Kremlin/Vale_Def_Words_Two.krml extract/Kremlin/Vale_Lib_Seqs.krml extract/Kremlin/Vale_Def_TypesNative_s.krml extract/Kremlin/Vale_Arch_TypesNative.krml extract/Kremlin/Vale_Def_Words_Seq.krml extract/Kremlin/Vale_Arch_Types.krml extract/Kremlin/Vale_Curve25519_Fast_defs.krml extract/Kremlin/FStar_Algebra_CommMonoid.krml extract/Kremlin/FStar_Tactics_CanonCommSemiring.krml extract/Kremlin/Vale_Curve25519_FastUtil_helpers.krml extract/Kremlin/Vale_Curve25519_FastHybrid_helpers.krml extract/Kremlin/Vale_Curve25519_Fast_lemmas_external.krml extract/Kremlin/Vale_X64_Regs.krml extract/Kremlin/FStar_Float.krml extract/Kremlin/FStar_IO.krml extract/Kremlin/Vale_Def_PossiblyMonad.krml extract/Kremlin/LowStar_BufferView_Down.krml extract/Kremlin/LowStar_BufferView_Up.krml extract/Kremlin/Vale_Interop_Views.krml extract/Kremlin/FStar_Option.krml extract/Kremlin/Vale_Lib_Set.krml extract/Kremlin/Vale_X64_Instruction_s.krml extract/Kremlin/Vale_X64_Bytes_Code_s.krml extract/Kremlin/Vale_AES_AES_s.krml extract/Kremlin/Vale_Math_Poly2_Defs_s.krml extract/Kremlin/Vale_Math_Poly2_s.krml extract/Kremlin/Vale_Math_Poly2_Bits_s.krml extract/Kremlin/Spec_Hash_Definitions.krml extract/Kremlin/Spec_Hash_Lemmas0.krml extract/Kremlin/Spec_Hash_PadFinish.krml extract/Kremlin/Spec_SHA2_Constants.krml extract/Kremlin/Spec_SHA2.krml extract/Kremlin/Vale_X64_CryptoInstructions_s.krml extract/Kremlin/Vale_X64_Instructions_s.krml extract/Kremlin/Vale_Arch_HeapTypes_s.krml extract/Kremlin/Vale_Interop_Types.krml extract/Kremlin/Vale_Arch_MachineHeap_s.krml extract/Kremlin/Vale_Interop_Heap_s.krml extract/Kremlin/LowStar_Modifies.krml extract/Kremlin/LowStar_ModifiesPat.krml extract/Kremlin/LowStar_BufferView.krml extract/Kremlin/Vale_Lib_BufferViewHelpers.krml extract/Kremlin/Vale_Interop.krml extract/Kremlin/Vale_Arch_HeapImpl.krml extract/Kremlin/Vale_Arch_Heap.krml extract/Kremlin/Vale_X64_Machine_Semantics_s.krml extract/Kremlin/Vale_Interop_Base.krml extract/Kremlin/Vale_X64_Memory.krml extract/Kremlin/Vale_Arch_MachineHeap.krml extract/Kremlin/Vale_X64_Stack_i.krml extract/Kremlin/Vale_X64_Stack_Sems.krml extract/Kremlin/Vale_X64_BufferViewStore.krml extract/Kremlin/Vale_X64_Memory_Sems.krml extract/Kremlin/Vale_X64_State.krml extract/Kremlin/Vale_X64_StateLemmas.krml extract/Kremlin/Vale_X64_Lemmas.krml extract/Kremlin/Vale_X64_Print_s.krml extract/Kremlin/Vale_X64_Decls.krml extract/Kremlin/Vale_X64_QuickCode.krml extract/Kremlin/Vale_X64_QuickCodes.krml extract/Kremlin/Vale_X64_Taint_Semantics.krml extract/Kremlin/Vale_X64_InsLemmas.krml extract/Kremlin/Vale_X64_InsBasic.krml extract/Kremlin/Vale_X64_InsMem.krml extract/Kremlin/Vale_X64_InsVector.krml extract/Kremlin/Vale_X64_InsStack.krml extract/Kremlin/Vale_Curve25519_X64_FastHybrid.krml extract/Kremlin/Vale_Bignum_Defs.krml extract/Kremlin/Vale_Bignum_X64.krml extract/Kremlin/Vale_Curve25519_FastSqr_helpers.krml extract/Kremlin/Vale_Curve25519_X64_FastSqr.krml extract/Kremlin/Vale_Curve25519_FastMul_helpers.krml extract/Kremlin/Vale_Curve25519_X64_FastMul.krml extract/Kremlin/Vale_Curve25519_X64_FastWide.krml extract/Kremlin/Vale_Curve25519_X64_FastUtil.krml extract/Kremlin/Vale_X64_MemoryAdapters.krml extract/Kremlin/Vale_Interop_Assumptions.krml extract/Kremlin/Vale_Interop_X64.krml extract/Kremlin/Vale_AsLowStar_ValeSig.krml extract/Kremlin/Vale_AsLowStar_LowStarSig.krml extract/Kremlin/Vale_AsLowStar_MemoryHelpers.krml extract/Kremlin/Vale_AsLowStar_Wrapper.krml extract/Kremlin/Vale_Stdcalls_X64_Fadd.krml extract/Kremlin/Vale_Wrapper_X64_Fadd.krml extract/Kremlin/Spec_SHA1.krml extract/Kremlin/Spec_MD5.krml extract/Kremlin/Spec_Agile_Hash.krml extract/Kremlin/Spec_Hash_Incremental.krml extract/Kremlin/Spec_Hash_Lemmas.krml extract/Kremlin/FStar_Kremlin_Endianness.krml extract/Kremlin/Hacl_Hash_Lemmas.krml extract/Kremlin/Hacl_Hash_Definitions.krml extract/Kremlin/Hacl_Hash_PadFinish.krml extract/Kremlin/Hacl_Hash_MD.krml extract/Kremlin/Spec_SHA2_Lemmas.krml extract/Kremlin/Vale_X64_Stack.krml extract/Kremlin/Vale_SHA_SHA_helpers.krml extract/Kremlin/Vale_X64_InsSha.krml extract/Kremlin/Vale_SHA_X64.krml extract/Kremlin/Vale_Stdcalls_X64_Sha.krml extract/Kremlin/FStar_BV.krml extract/Kremlin/FStar_Reflection_Arith.krml extract/Kremlin/FStar_Tactics_BV.krml extract/Kremlin/Vale_Lib_Bv_s.krml extract/Kremlin/Vale_Math_Bits.krml extract/Kremlin/Vale_Lib_Tactics.krml extract/Kremlin/Vale_Poly1305_Bitvectors.krml extract/Kremlin/Vale_Math_Lemmas_Int.krml extract/Kremlin/FStar_Tactics_Canon.krml extract/Kremlin/Vale_Poly1305_Spec_s.krml extract/Kremlin/Vale_Poly1305_Math.krml extract/Kremlin/Vale_Poly1305_Util.krml extract/Kremlin/Vale_Poly1305_X64.krml extract/Kremlin/Vale_Stdcalls_X64_Poly.krml extract/Kremlin/Vale_Wrapper_X64_Poly.krml extract/Kremlin/Vale_Arch_BufferFriend.krml extract/Kremlin/Vale_SHA_Simplify_Sha.krml extract/Kremlin/Vale_Wrapper_X64_Sha.krml extract/Kremlin/Hacl_Hash_Core_SHA2_Constants.krml extract/Kremlin/Hacl_Hash_Core_SHA2.krml extract/Kremlin/Hacl_Hash_SHA2.krml extract/Kremlin/Hacl_Hash_Core_SHA1.krml extract/Kremlin/Hacl_Hash_SHA1.krml extract/Kremlin/Hacl_Hash_Core_MD5.krml extract/Kremlin/Hacl_Hash_MD5.krml extract/Kremlin/C.krml extract/Kremlin/C_String.krml extract/Kremlin/C_Failure.krml extract/Kremlin/FStar_Int31.krml extract/Kremlin/FStar_UInt31.krml extract/Kremlin/FStar_Integers.krml extract/Kremlin/EverCrypt_StaticConfig.krml extract/Kremlin/EverCrypt_TargetConfig.krml extract/Kremlin/Vale_Lib_Basic.krml extract/Kremlin/Vale_Lib_X64_Cpuid.krml extract/Kremlin/Vale_Lib_X64_Cpuidstdcall.krml extract/Kremlin/Vale_Stdcalls_X64_Cpuid.krml extract/Kremlin/Vale_Wrapper_X64_Cpuid.krml extract/Kremlin/EverCrypt_AutoConfig2.krml extract/Kremlin/EverCrypt_Helpers.krml extract/Kremlin/EverCrypt_Hash.krml extract/Kremlin/Spec_Agile_HMAC.krml extract/Kremlin/Hacl_HMAC.krml extract/Kremlin/EverCrypt_HMAC.krml extract/Kremlin/Declassify.krml extract/Kremlin/FStar_Bytes.krml extract/Kremlin/Hashing_Spec.krml extract/Kremlin/LowParse_Bytes32.krml extract/Kremlin/LowParse_Bytes.krml extract/Kremlin/LowParse_Spec_Base.krml extract/Kremlin/LowParse_SLow_Base.krml extract/Kremlin/LowParse_Spec_Option.krml extract/Kremlin/LowParse_SLow_Option.krml extract/Kremlin/LowParse_Spec_Combinators.krml extract/Kremlin/LowParse_Spec_IfThenElse.krml extract/Kremlin/LowParse_SLow_Combinators.krml extract/Kremlin/LowParse_Spec_List.krml extract/Kremlin/LowParse_SLow_List.krml extract/Kremlin/Spec_Curve25519_Lemmas.krml extract/Kremlin/Spec_Curve25519.krml extract/Kremlin/Hacl_Spec_Curve25519_AddAndDouble.krml extract/Kremlin/Hacl_Impl_Curve25519_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Definition.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64_Core.krml extract/Kremlin/Hacl_Spec_Curve25519_Field64.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51_Definition.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51_Lemmas.krml extract/Kremlin/Hacl_Spec_Curve25519_Field51.krml extract/Kremlin/Hacl_Impl_Curve25519_Fields_Core.krml extract/Kremlin/Hacl_Impl_Curve25519_Field64.krml extract/Kremlin/Hacl_Impl_Curve25519_Field51.krml extract/Kremlin/Hacl_Impl_Curve25519_Fields.krml extract/Kremlin/Hacl_Impl_Curve25519_AddAndDouble.krml extract/Kremlin/Spec_Poly1305.krml extract/Kremlin/Hacl_Spec_Poly1305_Vec.krml extract/Kremlin/Hacl_Spec_Poly1305_Field32xN.krml extract/Kremlin/Hacl_Poly1305_Field32xN_Lemmas.krml extract/Kremlin/Hacl_Impl_Poly1305_Lemmas.krml extract/Kremlin/Hacl_Spec_Poly1305_Field32xN_Lemmas.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN.krml extract/Kremlin/Hacl_Spec_Poly1305_Lemmas.krml extract/Kremlin/Hacl_Spec_Poly1305_Equiv.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_256.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_128.krml extract/Kremlin/Hacl_Impl_Poly1305_Field32xN_32.krml extract/Kremlin/Hacl_Impl_Poly1305_Fields.krml extract/Kremlin/Hacl_Impl_Poly1305.krml extract/Kremlin/Spec_Chacha20Poly1305.krml extract/Kremlin/Hacl_Impl_Chacha20Poly1305_PolyCore.krml extract/Kremlin/Hacl_Impl_Chacha20Poly1305.krml extract/Kremlin/FStar_List_Pure_Base.krml extract/Kremlin/FStar_List_Pure_Properties.krml extract/Kremlin/FStar_List_Pure.krml extract/Kremlin/Meta_Interface.krml extract/Kremlin/Hacl_Meta_Chacha20Poly1305.krml extract/Kremlin/Hacl_Impl_Chacha20_Core32.krml extract/Kremlin/Hacl_Impl_Chacha20.krml extract/Kremlin/Hacl_Chacha20.krml extract/Kremlin/Hacl_Meta_Poly1305.krml extract/Kremlin/Hacl_Poly1305_32.krml extract/Kremlin/Hacl_Chacha20Poly1305_32.krml extract/Kremlin/FStar_Dyn.krml extract/Kremlin/LowStar_Failure.krml extract/Kremlin/EverCrypt_Vale.krml extract/Kremlin/EverCrypt_Specs.krml extract/Kremlin/EverCrypt_OpenSSL.krml extract/Kremlin/EverCrypt_Hacl.krml extract/Kremlin/EverCrypt_BCrypt.krml extract/Kremlin/EverCrypt_Cipher.krml extract/Kremlin/Hacl_Spec_Curve25519_Finv.krml extract/Kremlin/Hacl_Impl_Curve25519_Finv.krml extract/Kremlin/Hacl_Impl_Curve25519_Generic.krml extract/Kremlin/Hacl_Meta_Curve25519.krml extract/Kremlin/Hacl_Curve25519_51.krml extract/Kremlin/Vale_Stdcalls_X64_Fswap.krml extract/Kremlin/Vale_Wrapper_X64_Fswap.krml extract/Kremlin/Vale_X64_Print_Inline_s.krml extract/Kremlin/Vale_Inline_X64_Fswap_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fsqr.krml extract/Kremlin/Vale_Wrapper_X64_Fsqr.krml extract/Kremlin/Vale_Inline_X64_Fsqr_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fmul.krml extract/Kremlin/Vale_Wrapper_X64_Fmul.krml extract/Kremlin/Vale_Inline_X64_Fmul_inline.krml extract/Kremlin/Vale_Stdcalls_X64_Fsub.krml extract/Kremlin/Vale_Wrapper_X64_Fsub.krml extract/Kremlin/Vale_Inline_X64_Fadd_inline.krml extract/Kremlin/Hacl_Impl_Curve25519_Field64_Vale.krml extract/Kremlin/Hacl_Curve25519_64.krml extract/Kremlin/EverCrypt_Curve25519.krml extract/Kremlin/Hacl_Poly1305_128.krml extract/Kremlin/Hacl_Poly1305_256.krml extract/Kremlin/Vale_Poly1305_Equiv.krml extract/Kremlin/Vale_Poly1305_CallingFromLowStar.krml extract/Kremlin/EverCrypt_Poly1305.krml extract/Kremlin/Lib_Memzero.krml extract/Kremlin/Spec_HMAC_DRBG.krml extract/Kremlin/Hacl_HMAC_DRBG.krml extract/Kremlin/Lib_RandomBuffer_System.krml extract/Kremlin/EverCrypt_DRBG.krml extract/Kremlin/Spec_Agile_HKDF.krml extract/Kremlin/Hacl_HKDF.krml extract/Kremlin/EverCrypt_HKDF.krml extract/Kremlin/EverCrypt.krml extract/Kremlin/FStar_Printf.krml extract/Kremlin/FStar_Error.krml extract/Kremlin/FStar_Tcp.krml extract/Kremlin/LowParse_Spec_FLData.krml extract/Kremlin/LowParse_Math.krml extract/Kremlin/LowParse_Slice.krml extract/Kremlin/LowParse_Low_Base.krml extract/Kremlin/LowParse_Low_Combinators.krml extract/Kremlin/LowParse_Low_FLData.krml extract/Kremlin/LowParse_Spec_Seq.krml extract/Kremlin/LowParse_Spec_Int.krml extract/Kremlin/LowParse_Spec_BoundedInt.krml extract/Kremlin/LowParse_Low_Endianness.krml extract/Kremlin/LowParse_BitFields.krml extract/Kremlin/LowParse_Endianness.krml extract/Kremlin/LowParse_Endianness_BitFields.krml extract/Kremlin/LowParse_Low_BoundedInt.krml extract/Kremlin/LowParse_Spec_SeqBytes_Base.krml extract/Kremlin/LowParse_Spec_DER.krml extract/Kremlin/LowParse_Spec_BCVLI.krml extract/Kremlin/LowParse_Spec_AllIntegers.krml extract/Kremlin/LowParse_Spec_VLData.krml extract/Kremlin/LowParse_Low_VLData.krml extract/Kremlin/LowParse_Spec_VLGen.krml extract/Kremlin/LowParse_Low_VLGen.krml extract/Kremlin/LowParse_Low_Int.krml extract/Kremlin/LowParse_Low_DER.krml extract/Kremlin/LowParse_Low_BCVLI.krml extract/Kremlin/LowParse_Low_List.krml extract/Kremlin/LowParse_Spec_Array.krml extract/Kremlin/LowParse_Spec_VCList.krml extract/Kremlin/LowParse_Low_VCList.krml extract/Kremlin/LowParse_Low_IfThenElse.krml extract/Kremlin/LowParse_TacLib.krml extract/Kremlin/LowParse_Spec_Enum.krml extract/Kremlin/LowParse_Spec_Sum.krml extract/Kremlin/LowParse_Low_Enum.krml extract/Kremlin/LowParse_Low_Sum.krml extract/Kremlin/LowParse_Low_Tac_Sum.krml extract/Kremlin/LowParse_Low_Option.krml extract/Kremlin/LowParse_Spec_Bytes.krml extract/Kremlin/LowParse_Low_Bytes.krml extract/Kremlin/LowParse_Low_Array.krml extract/Kremlin/LowParse_Low.krml extract/Kremlin/LowParse_SLow_FLData.krml extract/Kremlin/LowParse_SLow_VLGen.krml extract/Kremlin/LowParse_Spec_Endianness.krml extract/Kremlin/LowParse_Spec_Endianness_Instances.krml extract/Kremlin/LowParse_SLow_Endianness.krml extract/Kremlin/LowParse_SLow_BoundedInt.krml extract/Kremlin/LowParse_SLow_Int.krml extract/Kremlin/LowParse_SLow_DER.krml extract/Kremlin/LowParse_SLow_BCVLI.krml extract/Kremlin/LowParse_SLow_VCList.krml extract/Kremlin/LowParse_SLow_IfThenElse.krml extract/Kremlin/LowParse_SLow_Enum.krml extract/Kremlin/LowParse_SLow_Sum.krml extract/Kremlin/LowParse_SLow_Tac_Enum.krml extract/Kremlin/LowParse_SLow_Tac_Sum.krml extract/Kremlin/LowParse_SLow_VLData.krml extract/Kremlin/LowParse_SLow_Bytes.krml extract/Kremlin/LowParse_SLow_Array.krml extract/Kremlin/LowParse_Spec_Tac_Combinators.krml extract/Kremlin/LowParse_SLow.krml extract/Kremlin/Parsers_AlertDescription.krml extract/Kremlin/Parsers_AlertLevel.krml extract/Kremlin/Parsers_Alert.krml extract/Kremlin/TLSError.krml extract/Kremlin/Parsers_NamedGroup.krml extract/Kremlin/Format_Constants.krml extract/Kremlin/Format_UncompressedPointRepresentation.krml extract/Kremlin/Format_KeyShareEntry.krml extract/Kremlin/Flags.krml extract/Kremlin/Parsers_ECCurveType.krml extract/Kremlin/DebugFlags.krml extract/Kremlin/FStar_DependentMap.krml extract/Kremlin/FStar_Monotonic_DependentMap.krml extract/Kremlin/Mem.krml extract/Kremlin/Random.krml extract/Kremlin/TLS_Curve25519.krml extract/Kremlin/Parse.krml extract/Kremlin/ECGroup.krml extract/Kremlin/DHGroup.krml extract/Kremlin/Parsers_NamedGroupList.krml extract/Kremlin/CommonDH.krml extract/Kremlin/FFICallbacks.krml extract/Kremlin/Parsers_CompressionMethod.krml extract/Kremlin/Parsers_SignatureScheme.krml extract/Kremlin/Parsers_SignatureSchemeList.krml extract/Kremlin/LowParseWrappers.krml extract/Kremlin/Parsers_CipherSuite.krml extract/Kremlin/CipherSuite.krml extract/Kremlin/Parsers_ProtocolVersion.krml extract/Kremlin/TLSConstants.krml extract/Kremlin/HMAC.krml extract/Kremlin/RSAKey.krml extract/Kremlin/PMS.krml extract/Kremlin/List_Helpers.krml extract/Kremlin/PSK.krml extract/Kremlin/Extensions.krml extract/Kremlin/Cert.krml extract/Kremlin/TLSInfoFlags.krml extract/Kremlin/FStar_Date.krml extract/Kremlin/Nonce.krml extract/Kremlin/TLSInfo.krml extract/Kremlin/Crypto_Indexing.krml extract/Kremlin/Flag.krml extract/Kremlin/FStar_Old_Endianness.krml extract/Kremlin/FStar_Buffer.krml extract/Kremlin/C_Compat_Loops.krml extract/Kremlin/Buffer_Utils.krml extract/Kremlin/Crypto_Symmetric_Bytes.krml extract/Kremlin/Crypto_Plain.krml extract/Kremlin/AEADProvider.krml extract/Kremlin/Range.krml extract/Kremlin/DataStream.krml extract/Kremlin/Alert.krml extract/Kremlin/Content.krml extract/Kremlin/StreamPlain.krml extract/Kremlin/Hashing.krml extract/Kremlin/TLSPRF.krml extract/Kremlin/Hashing_CRF.krml extract/Kremlin/HandshakeMessages.krml extract/Kremlin/HandshakeLog.krml extract/Kremlin/Parsers_Boolean.krml extract/Kremlin/Parsers_TicketContents13_custom_data.krml extract/Kremlin/Parsers_TicketContents13_nonce.krml extract/Kremlin/Parsers_TicketContents13_rms.krml extract/Kremlin/Parsers_TicketContents13.krml extract/Kremlin/Parsers_TicketContents12_master_secret.krml extract/Kremlin/Parsers_TicketContents12.krml extract/Kremlin/Parsers_TicketVersion.krml extract/Kremlin/Parsers_TicketContents.krml extract/Kremlin/Parsers_TicketContents12_master_secret_Low.krml extract/Kremlin/Parsers_Ticket_Low.krml extract/Kremlin/Ticket.krml extract/Kremlin/Negotiation.krml extract/Kremlin/FStar_Monotonic_Seq.krml extract/Kremlin/StreamAE.krml extract/Kremlin/StatefulPlain.krml extract/Kremlin/LHAEPlain.krml extract/Kremlin/AEAD_GCM.krml extract/Kremlin/StatefulLHAE.krml extract/Kremlin/StAE.krml extract/Kremlin/Old_HMAC_UFCMA.krml extract/Kremlin/Parsers_HKDF_HkdfLabel_context.krml extract/Kremlin/Parsers_HKDF_HkdfLabel_label.krml extract/Kremlin/Parsers_HKDF_HkdfLabel.krml extract/Kremlin/HKDF.krml extract/Kremlin/Old_KeySchedule.krml extract/Kremlin/Old_Epochs.krml extract/Kremlin/FStar_HyperStack_IO.krml extract/Kremlin/StreamDeltas.krml extract/Kremlin/Old_Handshake.krml extract/Kremlin/Transport.krml extract/Kremlin/BufferBytes.krml extract/Kremlin/Record.krml extract/Kremlin/Connection.krml extract/Kremlin/TLS.krml extract/Kremlin/FFI.krml extract/Kremlin/Pkg.krml extract/Kremlin/Idx.krml extract/Kremlin/Model.krml extract/Kremlin/FStar_Test.krml extract/Kremlin/Pkg_Tree.krml extract/Kremlin/KDF.krml extract/Kremlin/QUIC.krml extract/Kremlin/IV.krml extract/Kremlin/KDF_Rekey.krml -tmpdir extract/Kremlin-Library -skip-compilation
  F* version: 1f9505d5
  KreMLin version: 44acff92
 */

#include "TLSConstants.h"

bool TLSConstants_uu___is_Client(TLSConstants_role projectee)
{
  switch (projectee)
  {
    case TLSConstants_Client:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_uu___is_Server(TLSConstants_role projectee)
{
  switch (projectee)
  {
    case TLSConstants_Server:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

TLSConstants_role TLSConstants_dualRole(TLSConstants_role uu___0_130)
{
  switch (uu___0_130)
  {
    case TLSConstants_Client:
      {
        return TLSConstants_Server;
      }
    case TLSConstants_Server:
      {
        return TLSConstants_Client;
      }
    default:
      {
        KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
        KRML_HOST_EXIT(253U);
      }
  }
}

bool TLSConstants_uu___is_Reader(TLSConstants_rw projectee)
{
  switch (projectee)
  {
    case TLSConstants_Reader:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_uu___is_Writer(TLSConstants_rw projectee)
{
  switch (projectee)
  {
    case TLSConstants_Writer:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_is_pv_13(Parsers_ProtocolVersion_protocolVersion uu___1_163)
{
  if (uu___1_163.tag == Parsers_ProtocolVersion_TLS_1p3)
    return true;
  else
    return false;
}

/*
 Serializing function for the protocol version 
*/
FStar_Bytes_bytes TLSConstants_versionBytes(Parsers_ProtocolVersion_protocolVersion x)
{
  return Parsers_ProtocolVersion_protocolVersion_serializer32(x);
}

Prims_string TLSConstants_parse_protocolVersion_error_msg;

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Parsers_ProtocolVersion_protocolVersion
TLSError_fatal__Parsers_ProtocolVersion_protocolVersion(
  Parsers_AlertDescription_alertDescription a,
  Prims_string s
)
{
  return
    (
      (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Parsers_ProtocolVersion_protocolVersion){
        .tag = FStar_Error_Error,
        .val = { .case_Error = { .fst = TLSError_fatalAlert(a), .snd = s } }
      }
    );
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Parsers_ProtocolVersion_protocolVersion
TLSConstants_parseVersion(FStar_Bytes_bytes x)
{
  FStar_Pervasives_Native_option__K___Parsers_ProtocolVersion_protocolVersion_uint32_t
  scrut = Parsers_ProtocolVersion_protocolVersion_parser32(x);
  if (scrut.tag == FStar_Pervasives_Native_Some)
  {
    Parsers_ProtocolVersion_protocolVersion y = scrut.v.fst;
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Parsers_ProtocolVersion_protocolVersion){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = y }
        }
      );
  }
  else
    return
      TLSError_fatal__Parsers_ProtocolVersion_protocolVersion(Parsers_AlertDescription_Decode_error,
        FStar_Error_perror("TLSConstants.fst", (krml_checked_int_t)81, ""));
}

/*
 Determine the oldest protocol versions for TLS 
*/
Parsers_ProtocolVersion_protocolVersion
TLSConstants_minPV(
  Parsers_ProtocolVersion_protocolVersion a,
  Parsers_ProtocolVersion_protocolVersion b
)
{
  K___Parsers_ProtocolVersion_protocolVersion_Parsers_ProtocolVersion_protocolVersion
  scrut = { .fst = a, .snd = b };
  if (scrut.fst.tag == Parsers_ProtocolVersion_SSL_3p0)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_SSL_3p0 });
  else if (scrut.snd.tag == Parsers_ProtocolVersion_SSL_3p0)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_SSL_3p0 });
  else if (scrut.fst.tag == Parsers_ProtocolVersion_TLS_1p0)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p0 });
  else if (scrut.snd.tag == Parsers_ProtocolVersion_TLS_1p0)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p0 });
  else if (scrut.fst.tag == Parsers_ProtocolVersion_TLS_1p1)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p1 });
  else if (scrut.snd.tag == Parsers_ProtocolVersion_TLS_1p1)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p1 });
  else if (scrut.fst.tag == Parsers_ProtocolVersion_TLS_1p2)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p2 });
  else if (scrut.snd.tag == Parsers_ProtocolVersion_TLS_1p2)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p2 });
  else if (scrut.fst.tag == Parsers_ProtocolVersion_TLS_1p3)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p3 });
  else if (scrut.snd.tag == Parsers_ProtocolVersion_TLS_1p3)
    return ((Parsers_ProtocolVersion_protocolVersion){ .tag = Parsers_ProtocolVersion_TLS_1p3 });
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool
TLSConstants_geqPV(
  Parsers_ProtocolVersion_protocolVersion a,
  Parsers_ProtocolVersion_protocolVersion b
)
{
  return __eq__Parsers_ProtocolVersion_protocolVersion(b, TLSConstants_minPV(a, b));
}

Spec_Hash_Definitions_hash_alg TLSConstants_aeAlg_hash(CipherSuite_aeAlg uu___2_283)
{
  if (uu___2_283.tag == CipherSuite_MACOnly)
    return uu___2_283.val.case_MACOnly;
  else if (uu___2_283.tag == CipherSuite_MtE)
    return uu___2_283.val.case_MtE._1;
  else if (uu___2_283.tag == CipherSuite_AEAD)
    return uu___2_283.val.case_AEAD._1;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

/*
 Determine if this algorithm provide padding support with TLS 1.2 
*/
bool TLSConstants_lhae(CipherSuite_aeAlg uu___3_303)
{
  if (uu___3_303.tag == CipherSuite_MtE && uu___3_303.val.case_MtE._0.tag == CipherSuite_Block)
    return true;
  else if (uu___3_303.tag == CipherSuite_MACOnly)
    return false;
  else if (uu___3_303.tag == CipherSuite_AEAD)
    return false;
  else if
  (uu___3_303.tag == CipherSuite_MtE && uu___3_303.val.case_MtE._0.tag == CipherSuite_Stream)
    return false;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

/*
 Sequence numbers for StreamAE/StatefulLHAE 
*/
bool TLSConstants_is_seqn(Prims_int n1)
{
  return Prims_op_LessThanOrEqual(FStar_Bytes_repr_bytes(n1), (krml_checked_int_t)8);
}

bool
TLSConstants_strongAEAlg(
  Parsers_ProtocolVersion_protocolVersion uu____356,
  CipherSuite_aeAlg uu____357
)
{
  return false;
}

/*
 Encryption key sizes 
*/
Prims_int TLSConstants_encKeySize(CipherSuite_encAlg uu___4_367)
{
  if (uu___4_367.tag == CipherSuite_Stream && uu___4_367.val.case_Stream == EverCrypt_RC4_128)
    return (krml_checked_int_t)16;
  else if (uu___4_367.tag == CipherSuite_Block)
  {
    EverCrypt_block_cipher_alg a = uu___4_367.val.case_Block;
    return FStar_UInt32_v(EverCrypt_block_cipher_keyLen(a));
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

/*
 AEAD salt sizes 
*/
Prims_int TLSConstants_aeadSaltSize(EverCrypt_aead_alg uu___5_378)
{
  switch (uu___5_378)
  {
    case EverCrypt_AES128_GCM:
      {
        return (krml_checked_int_t)4;
      }
    case EverCrypt_AES256_GCM:
      {
        return (krml_checked_int_t)4;
      }
    case EverCrypt_CHACHA20_POLY1305:
      {
        return (krml_checked_int_t)12;
      }
    default:
      {
        return (krml_checked_int_t)4;
      }
  }
}

/*
 AEAD 
*/
Prims_int TLSConstants_aeadRecordIVSize(EverCrypt_aead_alg uu___6_392)
{
  switch (uu___6_392)
  {
    case EverCrypt_AES128_GCM:
      {
        return (krml_checked_int_t)8;
      }
    case EverCrypt_AES256_GCM:
      {
        return (krml_checked_int_t)8;
      }
    case EverCrypt_CHACHA20_POLY1305:
      {
        return (krml_checked_int_t)0;
      }
    default:
      {
        return (krml_checked_int_t)8;
      }
  }
}

Prims_int TLSConstants_max_TLSPlaintext_fragment_length = (krml_checked_int_t)16384;

Prims_int TLSConstants_max_TLSCompressed_fragment_length;

Prims_int TLSConstants_max_TLSCiphertext_fragment_length;

Prims_int TLSConstants_max_TLSCiphertext_fragment_length_13;

bool
TLSConstants_is_handshake13_signatureScheme(Parsers_SignatureScheme_signatureScheme uu___7_418)
{
  if (uu___7_418.tag == Parsers_SignatureScheme_Ecdsa_secp256r1_sha256)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Ecdsa_secp384r1_sha384)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Ecdsa_secp521r1_sha512)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Ed25519)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Ed448)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha256)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha384)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha512)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha256)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha384)
    return true;
  else if (uu___7_418.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha512)
    return true;
  else
    return false;
}

bool
TLSConstants_is_supported_signatureScheme(Parsers_SignatureScheme_signatureScheme uu___8_440)
{
  if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha1)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Ecdsa_sha1)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha256)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha384)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha512)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Ecdsa_secp256r1_sha256)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Ecdsa_secp384r1_sha384)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Ecdsa_secp521r1_sha512)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha256)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha384)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha512)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha256)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha384)
    return true;
  else if (uu___8_440.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha512)
    return true;
  else
    return false;
}

K___CipherSuite_sigAlg_Hashing_Spec_tls_alg
TLSConstants_sigHashAlg_of_signatureScheme(Parsers_SignatureScheme_signatureScheme s)
{
  if (s.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha1)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSASIG,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA1 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Ecdsa_sha1)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_ECDSA,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA1 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha256)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSASIG,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_256 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha384)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSASIG,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_384 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pkcs1_sha512)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSASIG,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_512 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Ecdsa_secp256r1_sha256)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_ECDSA,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_256 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Ecdsa_secp384r1_sha384)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_ECDSA,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_384 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Ecdsa_secp521r1_sha512)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_ECDSA,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_512 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha256)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_256 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha384)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_384 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_rsae_sha512)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_512 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha256)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_256 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha384)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_384 }
        }
      );
  else if (s.tag == Parsers_SignatureScheme_Rsa_pss_pss_sha512)
    return
      (
        (K___CipherSuite_sigAlg_Hashing_Spec_tls_alg){
          .fst = CipherSuite_RSAPSS,
          .snd = { .tag = Hashing_Spec_Hash, ._0 = Spec_Hash_Definitions_SHA2_512 }
        }
      );
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Parsers_SignatureScheme_signatureScheme
TLSConstants_signatureScheme_of_sigHashAlg(CipherSuite_sigAlg sa, Hashing_Spec_tls_alg ha)
{
  K___CipherSuite_sigAlg_Hashing_Spec_tls_alg scrut = { .fst = sa, .snd = ha };
  if
  (
    scrut.fst
    == CipherSuite_RSASIG
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_MD5
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Rsa_pkcs1_md5 });
  else if
  (
    scrut.fst
    == CipherSuite_RSASIG
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA1
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Rsa_pkcs1_sha1 });
  else if
  (
    scrut.fst
    == CipherSuite_RSASIG
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_256
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Rsa_pkcs1_sha256 });
  else if
  (
    scrut.fst
    == CipherSuite_RSASIG
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_384
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Rsa_pkcs1_sha384 });
  else if
  (
    scrut.fst
    == CipherSuite_RSASIG
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_512
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Rsa_pkcs1_sha512 });
  else if
  (
    scrut.fst
    == CipherSuite_ECDSA
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_MD5
  )
    return ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Ecdsa_md5 });
  else if
  (
    scrut.fst
    == CipherSuite_ECDSA
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA1
  )
    return
      ((Parsers_SignatureScheme_signatureScheme){ .tag = Parsers_SignatureScheme_Ecdsa_sha1 });
  else if
  (
    scrut.fst
    == CipherSuite_ECDSA
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_256
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Ecdsa_secp256r1_sha256
        }
      );
  else if
  (
    scrut.fst
    == CipherSuite_ECDSA
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_384
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Ecdsa_secp384r1_sha384
        }
      );
  else if
  (
    scrut.fst
    == CipherSuite_ECDSA
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_512
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Ecdsa_secp521r1_sha512
        }
      );
  else if
  (
    scrut.fst
    == CipherSuite_RSAPSS
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_256
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Rsa_pss_rsae_sha256
        }
      );
  else if
  (
    scrut.fst
    == CipherSuite_RSAPSS
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_384
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Rsa_pss_rsae_sha384
        }
      );
  else if
  (
    scrut.fst
    == CipherSuite_RSAPSS
    && scrut.snd.tag == Hashing_Spec_Hash && scrut.snd._0 == Spec_Hash_Definitions_SHA2_512
  )
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Rsa_pss_rsae_sha512
        }
      );
  else
    return
      (
        (Parsers_SignatureScheme_signatureScheme){
          .tag = Parsers_SignatureScheme_Unknown_signatureScheme,
          ._0 = (uint16_t)0U
        }
      );
}

FStar_Bytes_bytes
TLSConstants_signatureSchemeListBytes(
  Prims_list__Parsers_SignatureScheme_signatureScheme *algs
)
{
  return Parsers_SignatureSchemeList_signatureSchemeList_serializer32(algs);
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Parsers_SignatureScheme_signatureScheme
TLSError_fatal__Prims_list_Parsers_SignatureScheme_signatureScheme(
  Parsers_AlertDescription_alertDescription a,
  Prims_string s
)
{
  return
    (
      (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Parsers_SignatureScheme_signatureScheme){
        .tag = FStar_Error_Error,
        .val = { .case_Error = { .fst = TLSError_fatalAlert(a), .snd = s } }
      }
    );
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Parsers_SignatureScheme_signatureScheme
TLSConstants_parseSignatureSchemeList(FStar_Bytes_bytes b)
{
  Prims_string
  emsg =
    FStar_Error_perror("TLSConstants.fst",
      (krml_checked_int_t)257,
      "Failed to parse signature scheme list");
  FStar_Pervasives_Native_option__K___Prims_list__Parsers_SignatureScheme_signatureScheme_uint32_t
  scrut = Parsers_SignatureSchemeList_signatureSchemeList_parser32(b);
  if (scrut.tag == FStar_Pervasives_Native_Some)
  {
    Prims_list__Parsers_SignatureScheme_signatureScheme *y = scrut.v.fst;
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Parsers_SignatureScheme_signatureScheme){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = y }
        }
      );
  }
  else
    return
      TLSError_fatal__Prims_list_Parsers_SignatureScheme_signatureScheme(Parsers_AlertDescription_Decode_error,
        emsg);
}

FStar_Bytes_bytes TLSConstants_compressionBytes(Parsers_CompressionMethod_compressionMethod x)
{
  return Parsers_CompressionMethod_compressionMethod_serializer32(x);
}

Parsers_CompressionMethod_compressionMethod TLSConstants_parseCompression(FStar_Bytes_bytes x)
{
  FStar_Pervasives_Native_option__K___Parsers_CompressionMethod_compressionMethod_uint32_t
  scrut = Parsers_CompressionMethod_compressionMethod_parser32(x);
  if (scrut.tag == FStar_Pervasives_Native_Some)
    return scrut.v.fst;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Prims_list__Parsers_CompressionMethod_compressionMethod
*TLSConstants_parseCompressions(FStar_Bytes_bytes b)
{
  if (FStar_UInt32_v(FStar_Bytes_len(b)) == (krml_checked_int_t)0)
  {
    KRML_CHECK_SIZE(sizeof (Prims_list__Parsers_CompressionMethod_compressionMethod),
      (uint32_t)1U);
    Prims_list__Parsers_CompressionMethod_compressionMethod
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Parsers_CompressionMethod_compressionMethod));
    buf[0U] = ((Prims_list__Parsers_CompressionMethod_compressionMethod){ .tag = Prims_Nil });
    return buf;
  }
  else
  {
    K___FStar_Bytes_bytes_FStar_Bytes_bytes scrut = FStar_Bytes_split(b, (uint32_t)1U);
    FStar_Bytes_bytes cmB = scrut.fst;
    FStar_Bytes_bytes b_ = scrut.snd;
    Parsers_CompressionMethod_compressionMethod cm = TLSConstants_parseCompression(cmB);
    Prims_list__Parsers_CompressionMethod_compressionMethod
    *cms_ = TLSConstants_parseCompressions(b_);
    KRML_CHECK_SIZE(sizeof (Prims_list__Parsers_CompressionMethod_compressionMethod),
      (uint32_t)1U);
    Prims_list__Parsers_CompressionMethod_compressionMethod
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Parsers_CompressionMethod_compressionMethod));
    buf[0U]
    =
      (
        (Prims_list__Parsers_CompressionMethod_compressionMethod){
          .tag = Prims_Cons,
          .hd = cm,
          .tl = cms_
        }
      );
    return buf;
  }
}

FStar_Bytes_bytes
TLSConstants_compressionMethodsBytes(
  Prims_list__Parsers_CompressionMethod_compressionMethod *cms
)
{
  if (cms->tag == Prims_Cons)
  {
    Prims_list__Parsers_CompressionMethod_compressionMethod *cs = cms->tl;
    Parsers_CompressionMethod_compressionMethod c = cms->hd;
    return
      FStar_Bytes_append(TLSConstants_compressionBytes(c),
        TLSConstants_compressionMethodsBytes(cs));
  }
  else if (cms->tag == Prims_Nil)
    return FStar_Bytes_empty_bytes;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Bytes_bytes TLSConstants_extract_label;

FStar_Bytes_bytes TLSConstants_extended_extract_label;

FStar_Bytes_bytes TLSConstants_kdf_label;

bool TLSConstants_uu___is_PRF_SSL3_nested(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_SSL3_nested)
    return true;
  else
    return false;
}

bool TLSConstants_uu___is_PRF_SSL3_concat(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_SSL3_concat)
    return true;
  else
    return false;
}

bool TLSConstants_uu___is_PRF_TLS_1p01(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p01)
    return true;
  else
    return false;
}

FStar_Bytes_bytes TLSConstants___proj__PRF_TLS_1p01__item___0(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p01)
    return projectee.val.case_PRF_TLS_1p01;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_PRF_TLS_1p2(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p2)
    return true;
  else
    return false;
}

FStar_Bytes_bytes TLSConstants___proj__PRF_TLS_1p2__item___0(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p2)
    return projectee.val.case_PRF_TLS_1p2._0;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Spec_Hash_Definitions_hash_alg
TLSConstants___proj__PRF_TLS_1p2__item___1(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p2)
    return projectee.val.case_PRF_TLS_1p2._1;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_PRF_TLS_1p3(TLSConstants_prePrfAlg projectee)
{
  if (projectee.tag == TLSConstants_PRF_TLS_1p3)
    return true;
  else
    return false;
}

FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg
TLSConstants_prfMacAlg_of_ciphersuite_aux(CipherSuite_cipherSuite_ uu___9_782)
{
  if
  (
    uu___9_782.tag
    == CipherSuite_CipherSuite
    && uu___9_782.val.case_CipherSuite._2.tag == CipherSuite_MtE
  )
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = Spec_Hash_Definitions_SHA2_256
        }
      );
  else if
  (
    uu___9_782.tag
    == CipherSuite_CipherSuite
    && uu___9_782.val.case_CipherSuite._2.tag == CipherSuite_AEAD
  )
  {
    Spec_Hash_Definitions_hash_alg hAlg = uu___9_782.val.case_CipherSuite._2.val.case_AEAD._1;
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = hAlg
        }
      );
  }
  else if
  (
    uu___9_782.tag
    == CipherSuite_CipherSuite
    && uu___9_782.val.case_CipherSuite._2.tag == CipherSuite_MACOnly
  )
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = Spec_Hash_Definitions_SHA2_256
        }
      );
  else
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_None
        }
      );
}

bool
FStar_Pervasives_Native_uu___is_Some__Spec_Hash_Definitions_hash_alg(
  FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg projectee
)
{
  if (projectee.tag == FStar_Pervasives_Native_Some)
    return true;
  else
    return false;
}

/*
 Determine if the tuple PV and CS is the correct association with PRF 
*/
bool TLSConstants_pvcs(Parsers_ProtocolVersion_protocolVersion pv, CipherSuite_cipherSuite_ cs)
{
  K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_cipherSuite_
  scrut = { .fst = pv, .snd = cs };
  if
  (
    scrut.fst.tag
    == Parsers_ProtocolVersion_TLS_1p3
    && scrut.snd.tag == CipherSuite_CipherSuite13
  )
    return true;
  else if
  (scrut.fst.tag == Parsers_ProtocolVersion_TLS_1p3 && scrut.snd.tag == CipherSuite_CipherSuite)
    return false;
  else if (scrut.snd.tag == CipherSuite_CipherSuite)
    return
      FStar_Pervasives_Native_uu___is_Some__Spec_Hash_Definitions_hash_alg(TLSConstants_prfMacAlg_of_ciphersuite_aux(cs));
  else
    return false;
}

Spec_Hash_Definitions_hash_alg
TLSConstants_prfMacAlg_of_ciphersuite(CipherSuite_cipherSuite_ x)
{
  FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg
  x0 = TLSConstants_prfMacAlg_of_ciphersuite_aux(x);
  if (x0.tag == FStar_Pervasives_Native_Some)
    return x0.v;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

static FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg
TLSConstants_verifyDataHashAlg_of_ciphersuite_aux(CipherSuite_cipherSuite_ uu___10_891)
{
  if
  (
    uu___10_891.tag
    == CipherSuite_CipherSuite
    && uu___10_891.val.case_CipherSuite._2.tag == CipherSuite_MtE
  )
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = Spec_Hash_Definitions_SHA2_256
        }
      );
  else if
  (
    uu___10_891.tag
    == CipherSuite_CipherSuite
    && uu___10_891.val.case_CipherSuite._2.tag == CipherSuite_AEAD
  )
  {
    Spec_Hash_Definitions_hash_alg hAlg = uu___10_891.val.case_CipherSuite._2.val.case_AEAD._1;
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = hAlg
        }
      );
  }
  else if
  (
    uu___10_891.tag
    == CipherSuite_CipherSuite
    && uu___10_891.val.case_CipherSuite._2.tag == CipherSuite_MACOnly
  )
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = Spec_Hash_Definitions_SHA2_256
        }
      );
  else if (uu___10_891.tag == CipherSuite_CipherSuite13)
  {
    Spec_Hash_Definitions_hash_alg hAlg = uu___10_891.val.case_CipherSuite13._1;
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_Some,
          .v = hAlg
        }
      );
  }
  else
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_None
        }
      );
}

Spec_Hash_Definitions_hash_alg
TLSConstants_verifyDataHashAlg_of_ciphersuite(CipherSuite_cipherSuite_ x)
{
  FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg
  x0 = TLSConstants_verifyDataHashAlg_of_ciphersuite_aux(x);
  if (x0.tag == FStar_Pervasives_Native_Some)
    return x0.v;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg
TLSConstants_verifyDataHashAlg_of_ciphersuitename(Parsers_CipherSuite_cipherSuite n1)
{
  FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut0;
  if (n1.tag == Parsers_CipherSuite_TLS_NULL_WITH_NULL_NULL)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = { .tag = CipherSuite_NullCipherSuite }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite13,
            .val = {
              .case_CipherSuite13 = {
                ._0 = EverCrypt_AES128_GCM,
                ._1 = Spec_Hash_Definitions_SHA2_256
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite13,
            .val = {
              .case_CipherSuite13 = {
                ._0 = EverCrypt_AES256_GCM,
                ._1 = Spec_Hash_Definitions_SHA2_384
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite13,
            .val = {
              .case_CipherSuite13 = {
                ._0 = EverCrypt_CHACHA20_POLY1305,
                ._1 = Spec_Hash_Definitions_SHA2_256
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_AES_128_CCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite13,
            .val = {
              .case_CipherSuite13 = {
                ._0 = EverCrypt_AES128_CCM,
                ._1 = Spec_Hash_Definitions_SHA2_256
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_AES_128_CCM_8_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite13,
            .val = {
              .case_CipherSuite13 = {
                ._0 = EverCrypt_AES128_CCM8,
                ._1 = Spec_Hash_Definitions_SHA2_256
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_MD5)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MACOnly,
                  .val = { .case_MACOnly = Spec_Hash_Definitions_MD5 }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MACOnly,
                  .val = { .case_MACOnly = Spec_Hash_Definitions_SHA1 }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_NULL_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MACOnly,
                  .val = { .case_MACOnly = Spec_Hash_Definitions_SHA2_256 }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_MD5)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Stream,
                        .val = { .case_Stream = EverCrypt_RC4_128 }
                      },
                      ._1 = Spec_Hash_Definitions_MD5
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_RC4_128_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Stream,
                        .val = { .case_Stream = EverCrypt_RC4_128 }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_3DES_EDE_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_RC4_128_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Stream,
                        .val = { .case_Stream = EverCrypt_RC4_128 }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_RC4_128_MD5)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Stream,
                        .val = { .case_Stream = EverCrypt_RC4_128 }
                      },
                      ._1 = Spec_Hash_Definitions_MD5
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_3DES_EDE_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_TDES_EDE_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA1
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES128_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_CBC_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_MtE,
                  .val = {
                    .case_MtE = {
                      ._0 = {
                        .tag = CipherSuite_Block,
                        .val = { .case_Block = EverCrypt_AES256_CBC }
                      },
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_RSA_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_RSA,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DH,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_RSA_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DH,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_DSS_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DH,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_DSS_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DH,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_DSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_128_GCM_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES128_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DH_anon_WITH_AES_256_GCM_SHA384)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_AES256_GCM,
                      ._1 = Spec_Hash_Definitions_SHA2_384
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_ECDSA },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_RSA_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_Some, .v = CipherSuite_RSASIG },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_PSK_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_PSK,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_PSK_ECDHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else if (n1.tag == Parsers_CipherSuite_TLS_DHE_PSK_WITH_CHACHA20_POLY1305_SHA256)
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = {
            .tag = CipherSuite_CipherSuite,
            .val = {
              .case_CipherSuite = {
                ._0 = CipherSuite_Kex_PSK_DHE,
                ._1 = { .tag = FStar_Pervasives_Native_None },
                ._2 = {
                  .tag = CipherSuite_AEAD,
                  .val = {
                    .case_AEAD = {
                      ._0 = EverCrypt_CHACHA20_POLY1305,
                      ._1 = Spec_Hash_Definitions_SHA2_256
                    }
                  }
                }
              }
            }
          }
        }
      );
  else
    scrut0 =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_None
        }
      );
  FStar_Pervasives_Native_option__CipherSuite_cipherSuite_ scrut;
  if (scrut0.tag == FStar_Pervasives_Native_Some)
  {
    CipherSuite_cipherSuite_ v1 = scrut0.v;
    scrut =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_Some,
          .v = v1
        }
      );
  }
  else if (scrut0.tag == FStar_Pervasives_Native_None)
    scrut =
      (
        (FStar_Pervasives_Native_option__CipherSuite_cipherSuite_){
          .tag = FStar_Pervasives_Native_None
        }
      );
  else
    scrut =
      KRML_EABORT(FStar_Pervasives_Native_option__CipherSuite_cipherSuite_,
        "unreachable (pattern matches are exhaustive in F*)");
  if (scrut.tag == FStar_Pervasives_Native_None)
    return
      (
        (FStar_Pervasives_Native_option__Spec_Hash_Definitions_hash_alg){
          .tag = FStar_Pervasives_Native_None
        }
      );
  else if (scrut.tag == FStar_Pervasives_Native_Some)
  {
    CipherSuite_cipherSuite_ c = scrut.v;
    return TLSConstants_verifyDataHashAlg_of_ciphersuite_aux(c);
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Hashing_Spec_tls_alg
TLSConstants_sessionHashAlg(
  Parsers_ProtocolVersion_protocolVersion pv,
  CipherSuite_cipherSuite_ cs
)
{
  if (pv.tag == Parsers_ProtocolVersion_TLS_1p3)
    if (cs.tag == CipherSuite_CipherSuite13)
    {
      Spec_Hash_Definitions_hash_alg h1 = cs.val.case_CipherSuite13._1;
      return ((Hashing_Spec_tls_alg){ .tag = Hashing_Spec_Hash, ._0 = h1 });
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  else if (pv.tag == Parsers_ProtocolVersion_SSL_3p0)
    return ((Hashing_Spec_tls_alg){ .tag = Hashing_Spec_MD5SHA1 });
  else if (pv.tag == Parsers_ProtocolVersion_TLS_1p0)
    return ((Hashing_Spec_tls_alg){ .tag = Hashing_Spec_MD5SHA1 });
  else if (pv.tag == Parsers_ProtocolVersion_TLS_1p1)
    return ((Hashing_Spec_tls_alg){ .tag = Hashing_Spec_MD5SHA1 });
  else if (pv.tag == Parsers_ProtocolVersion_TLS_1p2)
    return
      (
        (Hashing_Spec_tls_alg){
          .tag = Hashing_Spec_Hash,
          ._0 = TLSConstants_verifyDataHashAlg_of_ciphersuite(cs)
        }
      );
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

CipherSuite_aeAlg TLSConstants_get_aeAlg(CipherSuite_cipherSuite_ cs)
{
  if (cs.tag == CipherSuite_CipherSuite)
    return cs.val.case_CipherSuite._2;
  else if (cs.tag == CipherSuite_CipherSuite13)
  {
    Spec_Hash_Definitions_hash_alg h1 = cs.val.case_CipherSuite13._1;
    EverCrypt_aead_alg a = cs.val.case_CipherSuite13._0;
    return
      (
        (CipherSuite_aeAlg){
          .tag = CipherSuite_AEAD,
          .val = { .case_AEAD = { ._0 = a, ._1 = h1 } }
        }
      );
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

typedef struct K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_aeAlg_s
{
  Parsers_ProtocolVersion_protocolVersion fst;
  CipherSuite_aeAlg snd;
}
K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_aeAlg;

K___CipherSuite_encAlg_CipherSuite_ivMode
TLSConstants_encAlg_of_aeAlg(Parsers_ProtocolVersion_protocolVersion pv, CipherSuite_aeAlg ae)
{
  K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_aeAlg scrut = { .fst = pv, .snd = ae };
  if
  (
    scrut.fst.tag
    == Parsers_ProtocolVersion_SSL_3p0
    && scrut.snd.tag == CipherSuite_MtE && scrut.snd.val.case_MtE._0.tag == CipherSuite_Block
  )
  {
    EverCrypt_block_cipher_alg e = scrut.snd.val.case_MtE._0.val.case_Block;
    return
      (
        (K___CipherSuite_encAlg_CipherSuite_ivMode){
          .fst = { .tag = CipherSuite_Block, .val = { .case_Block = e } },
          .snd = CipherSuite_Stale
        }
      );
  }
  else if
  (
    scrut.fst.tag
    == Parsers_ProtocolVersion_TLS_1p0
    && scrut.snd.tag == CipherSuite_MtE && scrut.snd.val.case_MtE._0.tag == CipherSuite_Block
  )
  {
    EverCrypt_block_cipher_alg e = scrut.snd.val.case_MtE._0.val.case_Block;
    return
      (
        (K___CipherSuite_encAlg_CipherSuite_ivMode){
          .fst = { .tag = CipherSuite_Block, .val = { .case_Block = e } },
          .snd = CipherSuite_Stale
        }
      );
  }
  else if (scrut.snd.tag == CipherSuite_MtE)
  {
    CipherSuite_encAlg e = scrut.snd.val.case_MtE._0;
    return ((K___CipherSuite_encAlg_CipherSuite_ivMode){ .fst = e, .snd = CipherSuite_Fresh });
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Spec_Hash_Definitions_hash_alg
TLSConstants_macAlg_of_aeAlg(Parsers_ProtocolVersion_protocolVersion pv, CipherSuite_aeAlg ae)
{
  K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_aeAlg scrut = { .fst = pv, .snd = ae };
  if (scrut.snd.tag == CipherSuite_MACOnly)
    return scrut.snd.val.case_MACOnly;
  else if (scrut.snd.tag == CipherSuite_MtE)
    return scrut.snd.val.case_MtE._1;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_RSA_sign(TLSConstants_certType projectee)
{
  switch (projectee)
  {
    case TLSConstants_RSA_sign:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_uu___is_DSA_sign(TLSConstants_certType projectee)
{
  switch (projectee)
  {
    case TLSConstants_DSA_sign:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_uu___is_RSA_fixed_dh(TLSConstants_certType projectee)
{
  switch (projectee)
  {
    case TLSConstants_RSA_fixed_dh:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

bool TLSConstants_uu___is_DSA_fixed_dh(TLSConstants_certType projectee)
{
  switch (projectee)
  {
    case TLSConstants_DSA_fixed_dh:
      {
        return true;
      }
    default:
      {
        return false;
      }
  }
}

FStar_Bytes_bytes TLSConstants_certTypeBytes(TLSConstants_certType ct)
{
  switch (ct)
  {
    case TLSConstants_RSA_sign:
      {
        return FStar_Bytes_abyte((uint8_t)1U);
      }
    case TLSConstants_DSA_sign:
      {
        return FStar_Bytes_abyte((uint8_t)2U);
      }
    case TLSConstants_RSA_fixed_dh:
      {
        return FStar_Bytes_abyte((uint8_t)3U);
      }
    case TLSConstants_DSA_fixed_dh:
      {
        return FStar_Bytes_abyte((uint8_t)4U);
      }
    default:
      {
        KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
        KRML_HOST_EXIT(253U);
      }
  }
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType
TLSError_fatal__TLSConstants_certType(
  Parsers_AlertDescription_alertDescription a,
  Prims_string s
)
{
  return
    (
      (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType){
        .tag = FStar_Error_Error,
        .val = { .case_Error = { .fst = TLSError_fatalAlert(a), .snd = s } }
      }
    );
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType
TLSConstants_parseCertType(FStar_Bytes_bytes b)
{
  switch (FStar_Bytes_get(b, (uint32_t)0U))
  {
    case 1U:
      {
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = TLSConstants_RSA_sign }
            }
          );
      }
    case 2U:
      {
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = TLSConstants_DSA_sign }
            }
          );
      }
    case 3U:
      {
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = TLSConstants_RSA_fixed_dh }
            }
          );
      }
    case 4U:
      {
        return
          (
            (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType){
              .tag = FStar_Error_Correct,
              .val = { .case_Correct = TLSConstants_DSA_fixed_dh }
            }
          );
      }
    default:
      {
        return
          TLSError_fatal__TLSConstants_certType(Parsers_AlertDescription_Decode_error,
            FStar_Error_perror("TLSConstants.fst", (krml_checked_int_t)468, ""));
      }
  }
}

FStar_Bytes_bytes TLSConstants_certificateTypeListBytes(Prims_list__TLSConstants_certType *ctl)
{
  if (ctl->tag == Prims_Nil)
    return FStar_Bytes_empty_bytes;
  else if (ctl->tag == Prims_Cons)
  {
    Prims_list__TLSConstants_certType *t = ctl->tl;
    TLSConstants_certType h1 = ctl->hd;
    FStar_Bytes_bytes ct = TLSConstants_certTypeBytes(h1);
    return FStar_Bytes_append(ct, TLSConstants_certificateTypeListBytes(t));
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

Prims_list__TLSConstants_certType
*TLSConstants_parseCertificateTypeList(FStar_Bytes_bytes data)
{
  if (FStar_UInt32_v(FStar_Bytes_len(data)) == (krml_checked_int_t)0)
  {
    KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
    Prims_list__TLSConstants_certType
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
    buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Nil });
    return buf;
  }
  else
  {
    K___FStar_Bytes_bytes_FStar_Bytes_bytes scrut0 = FStar_Bytes_split(data, (uint32_t)1U);
    FStar_Bytes_bytes thisByte = scrut0.fst;
    FStar_Bytes_bytes data1 = scrut0.snd;
    FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_TLSConstants_certType
    scrut = TLSConstants_parseCertType(thisByte);
    if (scrut.tag == FStar_Error_Error)
      return TLSConstants_parseCertificateTypeList(data1);
    else if (scrut.tag == FStar_Error_Correct)
    {
      TLSConstants_certType ct = scrut.val.case_Correct;
      Prims_list__TLSConstants_certType *rem1 = TLSConstants_parseCertificateTypeList(data1);
      KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
      Prims_list__TLSConstants_certType
      *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
      buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Cons, .hd = ct, .tl = rem1 });
      return buf;
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
}

Prims_list__TLSConstants_certType
*TLSConstants_defaultCertTypes(bool sign, CipherSuite_cipherSuite_ cs)
{
  CipherSuite_sigAlg alg = CipherSuite_sigAlg_of_ciphersuite(cs);
  if (sign)
    switch (alg)
    {
      case CipherSuite_RSASIG:
        {
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf0[0U]
          =
            (
              (Prims_list__TLSConstants_certType){
                .tag = Prims_Cons,
                .hd = TLSConstants_RSA_sign,
                .tl = buf
              }
            );
          return buf0;
        }
      case CipherSuite_DSA:
        {
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf0[0U]
          =
            (
              (Prims_list__TLSConstants_certType){
                .tag = Prims_Cons,
                .hd = TLSConstants_DSA_sign,
                .tl = buf
              }
            );
          return buf0;
        }
      default:
        {
          KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
            __FILE__,
            __LINE__,
            "[defaultCertTypes] invoked on an invalid ciphersuite");
          KRML_HOST_EXIT(255U);
        }
    }
  else
    switch (alg)
    {
      case CipherSuite_RSASIG:
        {
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf0[0U]
          =
            (
              (Prims_list__TLSConstants_certType){
                .tag = Prims_Cons,
                .hd = TLSConstants_RSA_fixed_dh,
                .tl = buf
              }
            );
          return buf0;
        }
      case CipherSuite_DSA:
        {
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf[0U] = ((Prims_list__TLSConstants_certType){ .tag = Prims_Nil });
          KRML_CHECK_SIZE(sizeof (Prims_list__TLSConstants_certType), (uint32_t)1U);
          Prims_list__TLSConstants_certType
          *buf0 = KRML_HOST_MALLOC(sizeof (Prims_list__TLSConstants_certType));
          buf0[0U]
          =
            (
              (Prims_list__TLSConstants_certType){
                .tag = Prims_Cons,
                .hd = TLSConstants_DSA_fixed_dh,
                .tl = buf
              }
            );
          return buf0;
        }
      default:
        {
          KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
            __FILE__,
            __LINE__,
            "[defaultCertTypes] invoked on an invalid ciphersuite");
          KRML_HOST_EXIT(255U);
        }
    }
}

FStar_Bytes_bytes TLSConstants_distinguishedNameListBytes(Prims_list__Prims_string *names)
{
  if (names->tag == Prims_Nil)
    return FStar_Bytes_empty_bytes;
  else if (names->tag == Prims_Cons)
  {
    Prims_list__Prims_string *t = names->tl;
    Prims_string h1 = names->hd;
    return
      FStar_Bytes_append(Parse_vlbytes2(FStar_Bytes_utf8_encode(h1)),
        TLSConstants_distinguishedNameListBytes(t));
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Prims_string
TLSError_fatal__Prims_list_Prims_string(
  Parsers_AlertDescription_alertDescription a,
  Prims_string s
)
{
  return
    (
      (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Prims_string){
        .tag = FStar_Error_Error,
        .val = { .case_Error = { .fst = TLSError_fatalAlert(a), .snd = s } }
      }
    );
}

FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Prims_string
TLSConstants_parseDistinguishedNameList(FStar_Bytes_bytes data, Prims_list__Prims_string *res)
{
  if (FStar_UInt32_v(FStar_Bytes_len(data)) == (krml_checked_int_t)0)
    return
      (
        (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Prims_string){
          .tag = FStar_Error_Correct,
          .val = { .case_Correct = res }
        }
      );
  else if (Prims_op_LessThan(FStar_UInt32_v(FStar_Bytes_len(data)), (krml_checked_int_t)2))
    return
      TLSError_fatal__Prims_list_Prims_string(Parsers_AlertDescription_Decode_error,
        FStar_Error_perror("TLSConstants.fst", (krml_checked_int_t)552, ""));
  else
  {
    FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_K___FStar_Bytes_bytes_FStar_Bytes_bytes
    scrut = Parse_vlsplit((krml_checked_int_t)2, data);
    if (scrut.tag == FStar_Error_Error)
    {
      K___Parsers_Alert_alert_Prims_string z = scrut.val.case_Error;
      return
        (
          (FStar_Error_optResult__K___Parsers_Alert_alert_Prims_string_Prims_list__Prims_string){
            .tag = FStar_Error_Error,
            .val = { .case_Error = z }
          }
        );
    }
    else if (scrut.tag == FStar_Error_Correct)
    {
      FStar_Bytes_bytes data1 = scrut.val.case_Correct.snd;
      FStar_Bytes_bytes nameBytes = scrut.val.case_Correct.fst;
      FStar_Pervasives_Native_option__Prims_string scrut = FStar_Bytes_iutf8_opt(nameBytes);
      if (scrut.tag == FStar_Pervasives_Native_None)
        return
          TLSError_fatal__Prims_list_Prims_string(Parsers_AlertDescription_Decode_error,
            FStar_Error_perror("TLSConstants.fst", (krml_checked_int_t)559, ""));
      else if (scrut.tag == FStar_Pervasives_Native_Some)
      {
        Prims_string name = scrut.v;
        if
        (
          Prims_op_LessThan(FStar_UInt32_v(FStar_Bytes_len(FStar_Bytes_utf8_encode(name))),
            (krml_checked_int_t)256)
        )
        {
          KRML_CHECK_SIZE(sizeof (Prims_list__Prims_string), (uint32_t)1U);
          Prims_list__Prims_string *res1 = KRML_HOST_MALLOC(sizeof (Prims_list__Prims_string));
          res1[0U] = ((Prims_list__Prims_string){ .tag = Prims_Cons, .hd = name, .tl = res });
          return TLSConstants_parseDistinguishedNameList(data1, res1);
        }
        else
          return
            TLSError_fatal__Prims_list_Prims_string(Parsers_AlertDescription_Decode_error,
              FStar_Error_perror("TLSConstants.fst", (krml_checked_int_t)564, ""));
      }
      else
      {
        KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
          __FILE__,
          __LINE__,
          "unreachable (pattern matches are exhaustive in F*)");
        KRML_HOST_EXIT(255U);
      }
    }
    else
    {
      KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
        __FILE__,
        __LINE__,
        "unreachable (pattern matches are exhaustive in F*)");
      KRML_HOST_EXIT(255U);
    }
  }
}

bool TLSConstants_uu___is_SNI_DNS(TLSConstants_serverName projectee)
{
  if (projectee.tag == TLSConstants_SNI_DNS)
    return true;
  else
    return false;
}

FStar_Bytes_bytes TLSConstants___proj__SNI_DNS__item___0(TLSConstants_serverName projectee)
{
  if (projectee.tag == TLSConstants_SNI_DNS)
    return projectee.val.case_SNI_DNS;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_SNI_UNKNOWN(TLSConstants_serverName projectee)
{
  if (projectee.tag == TLSConstants_SNI_UNKNOWN)
    return true;
  else
    return false;
}

K___Prims_int_FStar_Bytes_bytes
TLSConstants___proj__SNI_UNKNOWN__item___0(TLSConstants_serverName projectee)
{
  if (projectee.tag == TLSConstants_SNI_UNKNOWN)
    return projectee.val.case_SNI_UNKNOWN;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Pervasives_Native_option__FStar_Bytes_bytes
TLSConstants___proj__MkpskInfo__item__ticket_nonce(TLSConstants_pskInfo projectee)
{
  return projectee.ticket_nonce;
}

uint32_t TLSConstants___proj__MkpskInfo__item__time_created(TLSConstants_pskInfo projectee)
{
  return projectee.time_created;
}

uint32_t TLSConstants___proj__MkpskInfo__item__ticket_age_add(TLSConstants_pskInfo projectee)
{
  return projectee.ticket_age_add;
}

bool TLSConstants___proj__MkpskInfo__item__allow_early_data(TLSConstants_pskInfo projectee)
{
  return projectee.allow_early_data;
}

bool TLSConstants___proj__MkpskInfo__item__allow_dhe_resumption(TLSConstants_pskInfo projectee)
{
  return projectee.allow_dhe_resumption;
}

bool TLSConstants___proj__MkpskInfo__item__allow_psk_resumption(TLSConstants_pskInfo projectee)
{
  return projectee.allow_psk_resumption;
}

EverCrypt_aead_alg
TLSConstants___proj__MkpskInfo__item__early_ae(TLSConstants_pskInfo projectee)
{
  return projectee.early_ae;
}

Spec_Hash_Definitions_hash_alg
TLSConstants___proj__MkpskInfo__item__early_hash(TLSConstants_pskInfo projectee)
{
  return projectee.early_hash;
}

K___FStar_Bytes_bytes_FStar_Bytes_bytes
TLSConstants___proj__MkpskInfo__item__identities(TLSConstants_pskInfo projectee)
{
  return projectee.identities;
}

bool TLSConstants_uu___is_TicketInfo_12(TLSConstants_ticketInfo projectee)
{
  if (projectee.tag == TLSConstants_TicketInfo_12)
    return true;
  else
    return false;
}

K___Parsers_ProtocolVersion_protocolVersion_CipherSuite_cipherSuite__bool
TLSConstants___proj__TicketInfo_12__item___0(TLSConstants_ticketInfo projectee)
{
  if (projectee.tag == TLSConstants_TicketInfo_12)
    return projectee.val.case_TicketInfo_12;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_TicketInfo_13(TLSConstants_ticketInfo projectee)
{
  if (projectee.tag == TLSConstants_TicketInfo_13)
    return true;
  else
    return false;
}

TLSConstants_pskInfo
TLSConstants___proj__TicketInfo_13__item___0(TLSConstants_ticketInfo projectee)
{
  if (projectee.tag == TLSConstants_TicketInfo_13)
    return projectee.val.case_TicketInfo_13;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Dyn_dyn
TLSConstants___proj__Mkticket_cb__item__ticket_context(TLSConstants_ticket_cb projectee)
{
  return projectee.ticket_context;
}

void
(*TLSConstants___proj__Mkticket_cb__item__new_ticket(TLSConstants_ticket_cb projectee))(
  FStar_Dyn_dyn x0,
  Prims_string x1,
  FStar_Bytes_bytes x2,
  TLSConstants_ticketInfo x3,
  FStar_Bytes_bytes x4
)
{
  return projectee.new_ticket;
}

Prims_list__K___uint16_t_FStar_Bytes_bytes *TLSConstants_empty_custom_extensions()
{
  KRML_CHECK_SIZE(sizeof (Prims_list__K___uint16_t_FStar_Bytes_bytes), (uint32_t)1U);
  Prims_list__K___uint16_t_FStar_Bytes_bytes
  *buf = KRML_HOST_MALLOC(sizeof (Prims_list__K___uint16_t_FStar_Bytes_bytes));
  buf[0U] = ((Prims_list__K___uint16_t_FStar_Bytes_bytes){ .tag = Prims_Nil });
  return buf;
}

Prims_list__K___uint16_t_FStar_Bytes_bytes
*TLSConstants_add_custom_extension(
  Prims_list__K___uint16_t_FStar_Bytes_bytes *l,
  uint16_t hd1,
  FStar_Bytes_bytes b
)
{
  KRML_CHECK_SIZE(sizeof (Prims_list__K___uint16_t_FStar_Bytes_bytes), (uint32_t)1U);
  Prims_list__K___uint16_t_FStar_Bytes_bytes
  *buf = KRML_HOST_MALLOC(sizeof (Prims_list__K___uint16_t_FStar_Bytes_bytes));
  buf[0U]
  =
    (
      (Prims_list__K___uint16_t_FStar_Bytes_bytes){
        .tag = Prims_Cons,
        .hd = { .fst = hd1, .snd = b },
        .tl = l
      }
    );
  return buf;
}

bool TLSConstants_uu___is_Nego_abort(TLSConstants_nego_action projectee)
{
  if (projectee.tag == TLSConstants_Nego_abort)
    return true;
  else
    return false;
}

bool TLSConstants_uu___is_Nego_retry(TLSConstants_nego_action projectee)
{
  if (projectee.tag == TLSConstants_Nego_retry)
    return true;
  else
    return false;
}

FStar_Bytes_bytes
TLSConstants___proj__Nego_retry__item__cookie_extra(TLSConstants_nego_action projectee)
{
  if (projectee.tag == TLSConstants_Nego_retry)
    return projectee.val.case_Nego_retry;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

bool TLSConstants_uu___is_Nego_accept(TLSConstants_nego_action projectee)
{
  if (projectee.tag == TLSConstants_Nego_accept)
    return true;
  else
    return false;
}

Prims_list__K___uint16_t_FStar_Bytes_bytes
*TLSConstants___proj__Nego_accept__item__extra_ext(TLSConstants_nego_action projectee)
{
  if (projectee.tag == TLSConstants_Nego_accept)
    return projectee.val.case_Nego_accept;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

FStar_Dyn_dyn
TLSConstants___proj__Mknego_cb__item__nego_context(TLSConstants_nego_cb projectee)
{
  return projectee.nego_context;
}

TLSConstants_nego_action
(*TLSConstants___proj__Mknego_cb__item__negotiate(TLSConstants_nego_cb projectee))(
  FStar_Dyn_dyn x0,
  Parsers_ProtocolVersion_protocolVersion x1,
  FStar_Bytes_bytes x2,
  FStar_Pervasives_Native_option__FStar_Bytes_bytes x3
)
{
  return projectee.negotiate;
}

TLSConstants_cert_cb
TLSConstants_mk_cert_cb(
  FStar_Dyn_dyn app_ctx,
  FStar_Dyn_dyn cert_select_ptr,
  FStar_Pervasives_Native_option__K___uint64_t_Parsers_SignatureScheme_signatureScheme
  (*cert_select_cb)(
    FStar_Dyn_dyn x0,
    FStar_Dyn_dyn x1,
    Parsers_ProtocolVersion_protocolVersion x2,
    FStar_Bytes_bytes x3,
    FStar_Bytes_bytes x4,
    Prims_list__Parsers_SignatureScheme_signatureScheme *x5
  ),
  FStar_Dyn_dyn cert_format_ptr,
  Prims_list__FStar_Bytes_bytes
  *(*cert_format_cb)(FStar_Dyn_dyn x0, FStar_Dyn_dyn x1, uint64_t x2),
  FStar_Dyn_dyn cert_sign_ptr,
  FStar_Pervasives_Native_option__FStar_Bytes_bytes
  (*cert_sign_cb)(
    FStar_Dyn_dyn x0,
    FStar_Dyn_dyn x1,
    uint64_t x2,
    Parsers_SignatureScheme_signatureScheme x3,
    FStar_Bytes_bytes x4
  ),
  FStar_Dyn_dyn cert_verify_ptr,
  bool
  (*cert_verify_cb)(
    FStar_Dyn_dyn x0,
    FStar_Dyn_dyn x1,
    Prims_list__FStar_Bytes_bytes *x2,
    Parsers_SignatureScheme_signatureScheme x3,
    FStar_Bytes_bytes x4,
    FStar_Bytes_bytes x5
  )
)
{
  return
    (
      (TLSConstants_cert_cb){
        .app_context = app_ctx,
        .cert_select_ptr = cert_select_ptr,
        .cert_select_cb = cert_select_cb,
        .cert_format_ptr = cert_format_ptr,
        .cert_format_cb = cert_format_cb,
        .cert_sign_ptr = cert_sign_ptr,
        .cert_sign_cb = cert_sign_cb,
        .cert_verify_ptr = cert_verify_ptr,
        .cert_verify_cb = cert_verify_cb
      }
    );
}

Parsers_ProtocolVersion_protocolVersion
TLSConstants___proj__Mkconfig__item__min_version(TLSConstants_config projectee)
{
  return projectee.min_version;
}

Parsers_ProtocolVersion_protocolVersion
TLSConstants___proj__Mkconfig__item__max_version(TLSConstants_config projectee)
{
  return projectee.max_version;
}

bool TLSConstants___proj__Mkconfig__item__is_quic(TLSConstants_config projectee)
{
  return projectee.is_quic;
}

Prims_list__CipherSuite_cipherSuite_
*TLSConstants___proj__Mkconfig__item__cipher_suites(TLSConstants_config projectee)
{
  return projectee.cipher_suites;
}

Prims_list__Parsers_NamedGroup_namedGroup
*TLSConstants___proj__Mkconfig__item__named_groups(TLSConstants_config projectee)
{
  return projectee.named_groups;
}

Prims_list__Parsers_SignatureScheme_signatureScheme
*TLSConstants___proj__Mkconfig__item__signature_algorithms(TLSConstants_config projectee)
{
  return projectee.signature_algorithms;
}

bool TLSConstants___proj__Mkconfig__item__hello_retry(TLSConstants_config projectee)
{
  return projectee.hello_retry;
}

Prims_list__Parsers_NamedGroup_namedGroup
*TLSConstants___proj__Mkconfig__item__offer_shares(TLSConstants_config projectee)
{
  return projectee.offer_shares;
}

Prims_list__K___uint16_t_FStar_Bytes_bytes
*TLSConstants___proj__Mkconfig__item__custom_extensions(TLSConstants_config projectee)
{
  return projectee.custom_extensions;
}

Prims_list__K___FStar_Bytes_bytes_FStar_Bytes_bytes
*TLSConstants___proj__Mkconfig__item__use_tickets(TLSConstants_config projectee)
{
  return projectee.use_tickets;
}

FStar_Pervasives_Native_option__FStar_Bytes_bytes
TLSConstants___proj__Mkconfig__item__send_ticket(TLSConstants_config projectee)
{
  return projectee.send_ticket;
}

bool
TLSConstants___proj__Mkconfig__item__check_client_version_in_pms_for_old_tls(
  TLSConstants_config projectee
)
{
  return projectee.check_client_version_in_pms_for_old_tls;
}

bool
TLSConstants___proj__Mkconfig__item__request_client_certificate(TLSConstants_config projectee)
{
  return projectee.request_client_certificate;
}

bool TLSConstants___proj__Mkconfig__item__non_blocking_read(TLSConstants_config projectee)
{
  return projectee.non_blocking_read;
}

FStar_Pervasives_Native_option__uint32_t
TLSConstants___proj__Mkconfig__item__max_early_data(TLSConstants_config projectee)
{
  return projectee.max_early_data;
}

uint32_t TLSConstants___proj__Mkconfig__item__max_ticket_age(TLSConstants_config projectee)
{
  return projectee.max_ticket_age;
}

bool TLSConstants___proj__Mkconfig__item__safe_renegotiation(TLSConstants_config projectee)
{
  return projectee.safe_renegotiation;
}

bool TLSConstants___proj__Mkconfig__item__extended_master_secret(TLSConstants_config projectee)
{
  return projectee.extended_master_secret;
}

bool TLSConstants___proj__Mkconfig__item__enable_tickets(TLSConstants_config projectee)
{
  return projectee.enable_tickets;
}

TLSConstants_ticket_cb
TLSConstants___proj__Mkconfig__item__ticket_callback(TLSConstants_config projectee)
{
  return projectee.ticket_callback;
}

TLSConstants_nego_cb
TLSConstants___proj__Mkconfig__item__nego_callback(TLSConstants_config projectee)
{
  return projectee.nego_callback;
}

TLSConstants_cert_cb
TLSConstants___proj__Mkconfig__item__cert_callbacks(TLSConstants_config projectee)
{
  return projectee.cert_callbacks;
}

FStar_Pervasives_Native_option__Prims_list__FStar_Bytes_bytes
TLSConstants___proj__Mkconfig__item__alpn(TLSConstants_config projectee)
{
  return projectee.alpn;
}

FStar_Pervasives_Native_option__FStar_Bytes_bytes
TLSConstants___proj__Mkconfig__item__peer_name(TLSConstants_config projectee)
{
  return projectee.peer_name;
}

FStar_Pervasives_Native_option__K___uint64_t_Parsers_SignatureScheme_signatureScheme
TLSConstants_cert_select_cb(
  TLSConstants_config c,
  Parsers_ProtocolVersion_protocolVersion pv,
  FStar_Bytes_bytes sni,
  FStar_Bytes_bytes alpn,
  Prims_list__Parsers_SignatureScheme_signatureScheme *sig_6933
)
{
  return
    c.cert_callbacks.cert_select_cb(c.cert_callbacks.app_context,
      c.cert_callbacks.cert_select_ptr,
      pv,
      sni,
      alpn,
      sig_6933);
}

Prims_list__FStar_Bytes_bytes *TLSConstants_cert_format_cb(TLSConstants_config c, uint64_t ct)
{
  return
    c.cert_callbacks.cert_format_cb(c.cert_callbacks.app_context,
      c.cert_callbacks.cert_format_ptr,
      ct);
}

FStar_Pervasives_Native_option__FStar_Bytes_bytes
TLSConstants_cert_sign_cb(
  TLSConstants_config c,
  uint64_t ct,
  Parsers_SignatureScheme_signatureScheme ss,
  FStar_Bytes_bytes tbs
)
{
  return
    c.cert_callbacks.cert_sign_cb(c.cert_callbacks.app_context,
      c.cert_callbacks.cert_sign_ptr,
      ct,
      ss,
      tbs);
}

bool
TLSConstants_cert_verify_cb(
  TLSConstants_config c,
  Prims_list__FStar_Bytes_bytes *cl,
  Parsers_SignatureScheme_signatureScheme ss,
  FStar_Bytes_bytes tbs,
  FStar_Bytes_bytes sigv
)
{
  return
    c.cert_callbacks.cert_verify_cb(c.cert_callbacks.app_context,
      c.cert_callbacks.cert_verify_ptr,
      cl,
      ss,
      tbs,
      sigv);
}

